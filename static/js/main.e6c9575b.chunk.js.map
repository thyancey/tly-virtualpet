{"version":3,"sources":["scenes/app/loader.js","scenes/app/pinger.js","components/pet/index.js","components/animation-canvas/_animations.js","components/pet/pet-brain.js","scenes/cage/components/scene.js","scenes/info/components/stat-event-button.js","store/selectors/index.js","scenes/menu/components/panel-petselection.js","components/ui/dropmenu.js","scenes/menu/components/settings-slider.js","reportWebVitals.js","util/tools.js","scenes/menu/components/assets/unfold_more.svg","scenes/menu/components/assets/unfold_less.svg","scenes/menu/components/panel-base.js","scenes/menu/components/panel-settings.js","scenes/menu/menu-panel.js","scenes/menu/index.js","scenes/info/components/effect-marker.js","scenes/info/components/progress-bar.js","scenes/info/index.js","scenes/app/main.js","scenes/editor/pet-cell.js","scenes/editor/index.js","components/animation-canvas/hook-canvas.js","components/animation-canvas/index.js","index.js","store/actions/index.js","components/ui/button.js","themes/index.js","util/pet-store.js","store/actions/pet.js","util/item-store.js","scenes/cage/index.js","util/manifest-helper.js","util/logger.js","store/actions/transition.js","store/reducers/data.js","store/reducers/active-pet.js","store/index.js","store.js","scenes/app/index.js","store/selectors/routes.js"],"names":["LoadHelper","loadAllData","prevProps","prevState","nextManifestItem","this","props","id","loadManifestItem","nextExternalItem","url","global","setTimeout","setActivePetId","loadManifestData","manifestItemObj","console","error","fetch","mode","then","res","text","jsonc","parse","err","json","storeManifestItem","manifest","data","stack","type","location","log","setManifest","Component","connect","state","selectNextManifestItem","selectNextExternalItem","dispatch","bindActionCreators","require","Pinger","statPinger","pingIdx","ping","startStatPinger","pingRate","killStatPinger","onPing","clearInterval","selectSettingPingRate","fpsInterval","now","elapsed","frameRatio","S","PetContainer","styled","div","Centerer","Pet","idleTimer","thinkTimer","onKeyUp","bind","onKeyDown","vX","vY","aY","frames","petBrain","PetBrain","onBrainDoComplete","onBrainThinkComplete","rAF","keysDown","tick","petSize","posX","posY","minY","maxY","minX","maxX","isOnGround","cssX","cssY","adjustedWidth","adjustedHeight","adjustedRotation","direction","debugDraws","document","addEventListener","throttledThink","throttle","onThrottledThink","throttledLogic","onThrottledLogic","thinkInterval","window","setInterval","onPetInterval","stopRoaming","startRoaming","Date","resetPetPosition","setPersonality","personality","behavior","length","hasActivity","removeActivity","pullThePlug","think","checkKeys","setState","checkRoamingStuff","affectPetGravity","cancelAnimationFrame","amount","addActivity","jumpForce","forced","startIdleTimer","activities","indexOf","dX","dY","xForce","yForce","startWalking","userInput","killTimer","stopWalking","stopDucking","timerRef","clearTimeout","activityKey","getPetOnWall","movePet","Math","random","jumpChance","jumpPet","roamLeft","roamRight","forEach","k","startDucking","e","foundIdx","code","splice","push","newBounds","newPosition","newDirection","ctx","getAnimation","timePerc","clamp","maxVx","newY","newX","clampedX","clampedY","min","attemptToUpdatePosition","newStateObj","key","spriteInfo","animation","cageObj","activeCage","sceneType","activeSceneType","spriteScale","scale","spriteSize","cells","map","s","containerWidth","containerHeight","isNaN","width","Number","split","height","adjustedX","x","adjustedY","y","xCenter","yCenter","thisWidth","thisHeight","hitboxOffset","stateObj","floor","rotation","recalcMaxBounds","activePetId","petBox","clickPet","petId","checkForPetClicked","clientX","clientY","ani","p","drawCommands","faceDirection","getDrawCommand","orientation","dD","style","left","top","transform","onStageClick","selectActivePetId","selectActivePetBehavior","selectActivePetActivities","selectActivePetPersonality","selectActivePetAnimation","selectActiveCage","selectActiveSceneType","animationLabel","A","DebugDraw","bounds","coords","save","beginPath","arc","PI","globalAlpha","fillStyle","fill","lineWidth","strokeStyle","stroke","restore","SpinSquare","pos","clearRect","translate","rotate","fillRect","SpinSquare2","Sprite_Still","sprite","cCoords","getStillCellCoords","frame","sW","w","sH","h","drawImage","Sprite_Animated","idx","undefined","frameSkip","speed","getCellCoords","overlaySprite","sheetData","i","c","grid","r","fIdx","dir","STATUS","DEFAULT_PERSONALITY","onDoComplete","onThinkComplete","timer","status","name","callback","timerDuration","onTimerComplete","statusType","randBetween","getPersonality","thinkRange","doRange","stats","inputs","startDoing","startTimer","getDuration","startThinking","Scene","css","SceneFloor","image","color","SceneBackground","activeScene","bgImage","background","imageUrl","className","backgroundImage","backgroundColor","styles","alert","selectActiveScene","Wrapper","CooldownBar","getColor","StatEventButton","cooldownTimer","isCooling","coolAt","cooldown","getTime","startCooldownTimer","killCooldownTimer","coolDownComplete","statEventObj","startCooldown","triggerStatEffects","statEffects","sE","immediate","onImmediateUpdate","retString","percDone","round","cooldownWidth","getCooldownWidth","label","onClick","onButtonClick","isDisabled","tooltip","renderTooltip","getSettings","settings","getActivePetType","activePetType","getCounter","counter","getActivePetId","activePet","getForcedBehavior","forcedBehavior","createSelector","selectSettingVolume","volume","selectSettingAnimationSpeed","animationSpeed","selectIsLoadingComplete","loadingComplete","selectActivePets","getPets","allPets","filter","o","selectActivePetData","found","find","selectActivePet","activePetData","sceneId","scene","getSceneDefinition","cage","getFallbackValue","graphic","defaultValue","selectActiveDeltaStats","statRules","getStatRules","getDeltaStatsArray","selectActiveSceneStyles","selectActiveMoods","deltaStats","activeMoods","stat","effects","getActiveMoods","dsam","evaluateModifier","whenObj","statObj","evaluateCondition","when","whenMoods","matchedMoods","result","getFullStatEffectObj","moods","effect","mood","getPetDeltaStats","statPercent","current","max","cur","percent","fullIsGood","doesKill","fillType","evaluateWhen","moodSwingData","currentMoods","moodsMatched","evaluateMoods","activity","statValue","value","isDead","warn","selectActivePetDefinition","getPetDefinition","petDef","isAlive","moodSwings","m","whenResult","checkMoodSwingForBehavior","aData","statusObj","behaviors","DEFAULT","sprites","animIdx","animations","overlayLabel","overlay","foundAnimation","assetDir","overlayUrl","overlays","createSpriteObj","selectPetTaxonomy","getTaxonomy","taxonomy","Body","PetSelection","history","search","onSelectPet","prompt","loadExternalItem","activeObjects","setActivePetType","showLoadPrompt","isActive","onItemClick","payload","activeId","items","aO","subText","animal","withRouter","MenuLabel","DropMenu","themeGet","shadeColor","DropItem","DropItemImgContainer","DropItemLabel","DropItems","isOpen","thumbnail","onItemClicked","src","fallbackImage","initialImage","alt","Label","RangeInput","input","isInverted","SettingsSlider","throttleTimer","time","killThrottleTimer","startThrottleTimer","setSettingsValue","title","step","disabled","onChange","onChangeSlider","target","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","number","pad","rounder","pow","val","range","isObj","obj","convertStringsToNumbersInDeepObj","parsedObj","retObj","parsedValue","prefixValueInDeepObj","prefixKey","prefixValue","setObjToCookie","cookieName","cookieValue","JSON","stringify","setCookie","getCookieObj","cookieString","getCookie","cname","cvalue","expires","d","setTime","toUTCString","cookie","ca","decodeURIComponent","charAt","substring","deleteCookie","getSearchObj","searchString","queryString","VALID_CONDITIONS","getConditionDirection","condition","parseExpressionString","expressionString","valueTokens","percentageSplit","criteria","isPercent","checkValue","expression","evaluateExpression","Base","Header","PanelBase","onPanelClick","ICON_EXPAND","ICON_COLLAPSE","children","Item","li","PanelSettings","settingsData","Menu","MainPanel","getBreakpoint","mobile_tiny","tablet","PanelContainer","ResetButton","MenuButton","PanelBg","MenuPanel","onToggleMenu","deleteAllData","MenuContainer","MenuController","force","f","EffectMarker","Stick","Bubble","BubbleTip","isShowing","tooltipShowing","statLabel","retMessages","colorObj","effectMarker","percentVal","expressionObj","position","parseEffect","plus","minus","onMouseEnter","onEnterBubble","onMouseLeave","onLeaveBubble","renderMessage","ProgressBar","Bar","Value","span","BarGroup","Bg","EffectMarkers","augmentAction","sceneStyles","barColor","alertType","barStyles","getBarColor","getAlertType","bars","bgColor_minus","bgColor_plus","isOdd","mixin_clearBubble","StatDisplay","StatDisplayLabel","StatDisplayValue","FooterUi","EffectsContainer","Name","Level","InfoButton","Info","showInfo","PetStats","isInfoOpen","augmentStat","resetPet","ds","getDeadStats","killPet","forceBehavior","petData","behaviorIds","Object","keys","level","checkForDead","allMoods","mKey","updateStat","onToggleShowInfo","aId","statEvents","Main","Stage","section","CageContainer","InfoContainer","PetCell","PetFrame","Controls","Button","variant","Editor","theme","createMuiTheme","palette","primary","main","blue","ThemeProvider","ScopedCssBaseline","HookCanvas","canvasWidth","canvasHeight","drawProps","React","useState","canvasRef","setCanvasRef","useEffect","dC","ref","node","getContext","AnimationCanvas","img","overlayImg","loadStarted","Image","onload","updateImage","store","initLogger","logger","Logger","ReactDOM","render","getElementById","createAction","NotAButton","button","BigButton","LilButton","Tooltip","args","arg","colorId","black","grey","grey_light","white","green","yellow","red","purple","shadow","z1","z2","z3","headerHeight","menuWidth","mixins","breakpoints","mobile_medium","mobile_large","desktop","colId","R","parseInt","G","B","toString","pets","setFromPetManifest","savedData","getSavedData","savedPet","parsePetData","setPetDefinition","foundTypeIndex","findIndex","t","foundType","addToTaxonomy","defaultBehavior","parseMoodSwings","sEff","parseStatEvents","definedStats","initialStats","mergeStats","stats_saved","timestamp","formatSavedStatObj","saveAfter","petIdx","saveAllPetStatsToCookie","schemaVersion","origArray","newArray","overwrite","retArray","slice","newStat","matchingStatIdx","oStat","fancyUpSavedStats","savedStats","mergedStats","iS","savedStat","sS","mS","perSecond","getDeltaStats","statsObj","oldStats","timeDiff","killThisPet","augmentPetStat","statId","augmentValue","newValue","saveStats","saveAllPetStatsToCookieNow","resetPetState","reload","petStore","getAllData","getPetStoreData","itemType","scenes","setFromSceneManifest","converted","complete","addSceneDefinition","newDefinition","itemStore","getItems","getScenes","Cage","containerRef","createRef","onResize","updateCanvasDims","offsetWidth","offsetHeight","stages","stageIdx","returnNextStageItem","manifestStages","nextItemIdx","manifestStageIdx","nextItem","itemIdx","getNextManifestData","curItemIdx","nextItemObj","setManifestStages","manifestHelper","entries","logIdx","init","logLevel","output","logArgs","PublicInterface","send","sendQuiet","logNext","logPrevious","logLast","setTransitionAction","setTransition","transitionData","VALID_KEYS","initialState","customData","handleActions","action","cleanManifestObj","parsedData","isExternal","transitionLabel","settingsKey","storedValue","petObj","a","newBehavior","combineReducers","middleware","thunk","composedEnhancers","compose","applyMiddleware","createStore","rootReducer","App","AppContainer","onExitPage","onLoadComplete","loadDeeplinkedPet","petQuery","selectPetFromSearchQuery","queryPieces","exact","path","to","component","pet"],"mappings":"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","file":"static/js/main.e6c9575b.chunk.js","sourcesContent":["import { Component } from 'react';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport fetch from 'node-fetch';\nimport { jsonc } from 'jsonc';\n\nimport { setManifest, storeManifestItem, setActivePetId } from '@store/actions';\nimport { selectNextManifestItem, selectNextExternalItem } from '@store/selectors';\n\nlet dataLocation = './data';\n\nclass LoadHelper extends Component {\n\n  constructor(){\n    super();\n\n    this.loadAllData();\n  }\n\n  componentDidUpdate(prevProps, prevState){\n    const nextManifestItem = this.props.nextManifestItem;\n    if(nextManifestItem){\n      if(!prevProps.nextManifestItem || prevProps.nextManifestItem.id !== nextManifestItem.id){\n        //- load each pet def\n        this.loadManifestItem(nextManifestItem);\n      }\n    }\n    \n    const nextExternalItem = this.props.nextExternalItem;\n    if(nextExternalItem){\n      if(!prevProps.nextExternalItem || prevProps.nextExternalItem.url !== nextExternalItem.url){\n        //- load each pet def\n        this.loadManifestItem(nextExternalItem);\n        global.setTimeout(() => {this.props.setActivePetId(nextExternalItem.id)}, 500);\n      }\n    }\n  }\n\n  loadAllData(){\n    this.loadManifestData('manifest', 'manifest.jsonc');\n  }\n\n  loadManifestItem(manifestItemObj){\n    if(!manifestItemObj){\n      console.error('Loader.loadManifestItem, received null manifestItemObj');\n    }\n    // console.log('loadManifestItem', manifestItemObj)\n\n    const url =  `${manifestItemObj.url}/data.jsonc`;\n    // const manifestLabel = `( [${manifestItemObj.type}]: ${manifestItemObj.id} )`;\n    // console.log(`reading manifestItem data for ${manifestLabel} from '${url}'`);\n\n    fetch(url, {\n      mode: 'cors'\n    })\n      .then(res => res.text())\n      .then(\n        text => jsonc.parse(text), \n        err => {\n          console.error(`Error fretching item from manifestObj ${manifestItemObj} from ${url}`, err);\n        }\n      ) //- bad url responds with 200/ok? so this doesnt get thrown\n      .then(\n        json => {\n          // console.log(`manifestItem ${manifestLabel} was read successfully`, json);\n          this.props.storeManifestItem({ manifest: manifestItemObj, data: json })\n\n          return true;\n        }, \n        err => {\n          console.error(`Error parsing data from manifestObj ${manifestItemObj} (or the url (${url}) was bad), skipping`, err?.stack || err);\n        }\n      );\n  }\n\n  loadManifestData(type, location){\n    const url =  `${dataLocation}/${location}`;\n    console.log(`reading ${type} data from '${url}'`);\n\n    fetch(url)\n      .then(res => res.text())\n      .then(\n        text => {\n          return jsonc.parse(text);\n        }, \n        err => {\n          console.error(`Error fretching ${type} data from ${url}`, err);\n        }\n      ) //- bad url responds with 200/ok? so this doesnt get thrown\n      .then(\n        json => {\n          // console.log(`${type} data was read successfully`, json);\n          this.props.setManifest(json);\n          return true;\n        }, \n        err => {\n          console.error(`Error parsing ${type} data (or the url was bad), skipping`, err?.stack || err);\n        }\n      );\n  }\n\n\n  render(){\n    return null;\n  }\n}\n\nconst mapStateToProps = (state, props) => ({\n  nextManifestItem: selectNextManifestItem(state),\n  nextExternalItem: selectNextExternalItem(state)\n})\n\nconst mapDispatchToProps = dispatch =>\n  bindActionCreators(\n    { setManifest, storeManifestItem, setActivePetId  },\n    dispatch\n  )\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(LoadHelper)\n\n","import { Component } from 'react';\n\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport { ping } from '@store/actions';\nimport { selectSettingPingRate } from '@store/selectors';\n\nrequire('@themes/app.scss');\n\nclass Pinger extends Component {\n\n  constructor(){\n    super();\n    this.statPinger = null;\n\n    this.state = {\n      pingIdx: 0\n    }\n  }\n\n  componentDidMount(){\n    this.props.ping();\n    this.startStatPinger();\n  }\n\n  onPing(){\n    this.props.ping();\n\n    if(this.props.pingRate && this.props.pingRate > 0){\n      this.startStatPinger(this.props.pingRate);\n    }else{\n      this.killStatPinger();\n    }\n\n  }\n\n  startStatPinger(pingRate){\n    this.killStatPinger();\n\n    this.statPinger = global.setTimeout(() => {\n      this.onPing();\n    }, this.props.pingRate);\n  }\n\n  killStatPinger(){\n    if(this.statPinger){\n      global.clearInterval(this.statPinger);\n      this.statPinger = null;\n    }\n  }\n\n  render(){\n    return null;\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  pingRate: selectSettingPingRate(state)\n})\n\nconst mapDispatchToProps = dispatch =>\n  bindActionCreators(\n    { ping },\n    dispatch\n  )\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Pinger)\n\n","import React, { Component } from 'react';\r\nimport styled from 'styled-components';\r\n\r\nimport { bindActionCreators } from 'redux';\r\nimport { connect } from 'react-redux';\r\n\r\nimport AnimationCanvas from '../animation-canvas/';\r\nimport { getAnimation } from '../animation-canvas/_animations';\r\n\r\nimport PetBrain from './pet-brain';\r\n\r\nimport { clamp } from '@util/tools';\r\n\r\nimport { throttle } from 'throttle-debounce';\r\n\r\nimport {\r\n  addActivity,\r\n  removeActivity,\r\n  clickPet\r\n} from '../../store/actions/pet';\r\nimport { \r\n  selectActivePetId,\r\n  selectActivePetActivities,\r\n  selectActivePetPersonality,\r\n  selectActivePetAnimation,\r\n  selectActivePetBehavior,\r\n  selectActiveCage,\r\n  selectActiveSceneType\r\n} from '../../store/selectors';\r\n\r\nconst ENABLE_DEBUG_CLICKS = false;\r\nconst MAX_DEBUG_CLICKS = 10;\r\nconst DRAG_Y = .97;\r\nconst DRAG_X = .7;\r\nconst FALL_Y = .5;\r\n\r\nexport const INPUTS = {\r\n  MOVE_LEFT: 0,\r\n  MOVE_RIGHT: 1,\r\n  JUMP: 2,\r\n  DUCK: 3,\r\n  DEBUG_1: 4,\r\n  DEBUG_2: 5\r\n};\r\n\r\nconst fps = 60;\r\nlet fpsInterval;\r\nlet then;\r\nlet now;\r\nlet elapsed;\r\n// let startTime;\r\nlet frameRatio;\r\n\r\nlet maxPetSpeed = 2;\r\n\r\nconst S = {};\r\n\r\nS.PetContainer = styled.div`\r\n  position:absolute;\r\n  width:0;\r\n  height:0;\r\n`;\r\n\r\nS.Centerer = styled.div`\r\n  left:50%;\r\n  top:50%;\r\n  transform:translate(-50%, -50%);\r\n`;\r\n\r\nclass Pet extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.idleTimer = null;\r\n    this.thinkTimer = null;\r\n    this.onKeyUp = this.onKeyUp.bind(this);\r\n    this.onKeyDown = this.onKeyDown.bind(this);\r\n    this.vX = 0;\r\n    this.vY = 0;\r\n    this.aY = 1.08;\r\n    this.frames = 0;\r\n    this.petBrain = new PetBrain(this.onBrainDoComplete.bind(this), this.onBrainThinkComplete.bind(this));\r\n    this.rAF = 0;\r\n\r\n    this.keysDown = [];\r\n\r\n    this.state = {\r\n      tick: 0,\r\n      petSize: [0, 0],\r\n      posX: 0,\r\n      posY: 0,\r\n      minY: 0,\r\n      maxY: 0,\r\n      minX: 0,\r\n      maxX: 0,\r\n      isOnGround: false,\r\n      cssX: '0px',\r\n      cssY: '0px',\r\n      adjustedWidth: 0,\r\n      adjustedHeight: 0,\r\n      adjustedRotation: 0,\r\n      direction: 1,\r\n      debugDraws: []\r\n    }\r\n    global.document.addEventListener('keyup', this.onKeyUp);\r\n    global.document.addEventListener('keydown', this.onKeyDown);\r\n\r\n    this.throttledThink = throttle(200, true, () => {\r\n      this.onThrottledThink();\r\n    });\r\n    this.throttledLogic = throttle(200, true, () => {\r\n      this.onThrottledLogic();\r\n    });\r\n\r\n    this.thinkInterval = window.setInterval(this.onPetInterval.bind(this), 10);\r\n  }\r\n\r\n  onBrainDoComplete(){\r\n    this.stopRoaming();\r\n  }\r\n\r\n  onBrainThinkComplete(){\r\n    this.startRoaming();\r\n  }\r\n\r\n  componentDidMount() {    \r\n    fpsInterval = 1000 / fps;\r\n    then = Date.now();\r\n    this.resetPetPosition();\r\n    this.petBrain.setPersonality(this.props.personality);\r\n  }\r\n\r\n  onPetInterval(){\r\n    this.onThrottledLogic();\r\n    this.throttledThink();\r\n  }\r\n\r\n  onThrottledThink(){\r\n    if(this.props.behavior !== 'DEAD'){\r\n      //- if user input cancel any pet auto behavior\r\n      if(this.keysDown.length > 0){\r\n        if(this.hasActivity('ROAMING')) this.props.removeActivity('ROAMING');\r\n        this.petBrain.pullThePlug();\r\n      }else{\r\n        this.petBrain.think([], this.keysDown);\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  onThrottledLogic(){\r\n    now = Date.now();\r\n    elapsed = now - then;\r\n    frameRatio = elapsed / fpsInterval;\r\n    this.checkKeys(frameRatio);\r\n\r\n    if (frameRatio > 1) {\r\n      then = now - (elapsed % fpsInterval);\r\n      this.frames++;\r\n      this.setState(prevState => ({ \r\n        tick: this.frames \r\n      }));\r\n    }\r\n    \r\n    if(this.props.behavior !== 'DEAD' && this.hasActivity('ROAMING')){\r\n      this.checkRoamingStuff(frameRatio);\r\n    }\r\n    this.affectPetGravity(frameRatio);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    cancelAnimationFrame(this.rAF);\r\n  }\r\n\r\n  jumpPet(amount = 0){\r\n    if(this.state.isOnGround){\r\n      this.props.addActivity('JUMPING');\r\n      this.vY -= amount * this.props.personality.jumpForce;\r\n    }\r\n  }\r\n\r\n  startRoaming(){\r\n    this.props.addActivity('ROAMING');\r\n  }\r\n\r\n  stopRoaming(forced){\r\n    this.props.removeActivity('ROAMING');\r\n  }\r\n\r\n  startDucking(){\r\n    console.log('start ducking')\r\n    this.props.addActivity('DUCKING');\r\n\r\n    //- TODO, use debounce, but none of the npm modules worked for some reason\r\n    this.startIdleTimer();\r\n  }\r\n  \r\n  stopDucking(){\r\n    if(this.props.activities.indexOf('DUCKING') > -1){\r\n      this.props.removeActivity('DUCKING');\r\n    }\r\n  }\r\n\r\n  movePet(dX, dY, frameRatio){\r\n    this.vX += ((dX * frameRatio) * this.props.personality.xForce);\r\n    this.vY += ((dY * frameRatio) * this.props.personality.yForce);\r\n\r\n    if(dX < 0){\r\n      this.setState({\r\n        direction: -1\r\n      });\r\n    }else if(dX > 0){\r\n      this.setState({\r\n        direction: 1\r\n      });\r\n    }\r\n\r\n    this.startWalking();\r\n  }\r\n\r\n  stopWalking(){\r\n    if(this.props.activities.indexOf('WALKING') > -1){\r\n      this.props.removeActivity('WALKING');\r\n    }\r\n  }\r\n\r\n  startWalking(userInput){\r\n    this.props.addActivity('WALKING');\r\n\r\n    //- TODO, use debounce, but none of the npm modules worked for some reason\r\n    this.startIdleTimer();\r\n  }\r\n\r\n  startIdleTimer(){\r\n    this.killTimer(this.idleTimer);\r\n    this.idleTimer = global.setTimeout(() => {\r\n      this.stopWalking();\r\n      this.stopDucking();\r\n    }, 200)\r\n  }\r\n\r\n  killTimer(timerRef){\r\n    if(timerRef){\r\n      global.clearTimeout(timerRef);\r\n      timerRef = null;\r\n    }\r\n  }\r\n\r\n  hasActivity(activityKey){\r\n    // console.log('activities', this.props.activities)\r\n    return this.props.activities.indexOf(activityKey) > -1\r\n  }\r\n\r\n  roamLeft(frameRatio){\r\n    if(this.getPetOnWall() === -1){\r\n      this.movePet(1, 0, frameRatio);\r\n    }else{\r\n      this.movePet(-1, 0, frameRatio);\r\n    }\r\n  }\r\n\r\n  roamRight(frameRatio){\r\n    if(this.getPetOnWall() === 1){\r\n      this.movePet(-1, 0, frameRatio);\r\n    }else{\r\n      this.movePet(1, 0, frameRatio);\r\n    }\r\n  }\r\n\r\n  checkRoamingStuff(frameRatio){\r\n    if(this.hasActivity('ROAMING')){\r\n      if(Math.random() < this.props.personality.jumpChance){\r\n        this.jumpPet(20);\r\n      }\r\n      if(this.state.direction === -1){\r\n        this.roamLeft(frameRatio);\r\n      }else{\r\n        this.roamRight(frameRatio);\r\n      }\r\n    }\r\n  }\r\n\r\n  checkKeys(frameRatio){\r\n    this.keysDown.forEach(k => {\r\n      switch(k){\r\n        case 'ArrowRight': \r\n          this.movePet(1, 0, frameRatio);\r\n          break;\r\n        case 'ArrowLeft':\r\n          this.movePet(-1, 0, frameRatio);\r\n          break;\r\n        case 'ArrowUp':\r\n          this.jumpPet(20);\r\n          break;\r\n        case 'ArrowDown':\r\n          this.startDucking();\r\n          break;\r\n        default: break;\r\n      }\r\n    });\r\n  }\r\n\r\n  onKeyUp(e){\r\n    const foundIdx = this.keysDown.indexOf(e.code);\r\n    if(foundIdx > -1){\r\n      this.keysDown.splice(foundIdx, 1);\r\n    }\r\n  }\r\n\r\n  onKeyDown(e){\r\n    if(this.keysDown.indexOf(e.code) === -1){\r\n      this.keysDown.push(e.code);\r\n    }\r\n  }\r\n\r\n  getDrawCommand(type, newBounds, newPosition, newDirection){\r\n    return (ctx, props) => getAnimation(type)(ctx, newBounds, newPosition, newDirection, props);\r\n  }\r\n\r\n  affectPetGravity(timePerc){\r\n    /* gravity stuff */\r\n    this.vY = this.vY + FALL_Y;\r\n\r\n    if(this.vY > 0 && this.vY < .25){\r\n      this.vY = 0;\r\n    }else{\r\n      this.vY *= DRAG_Y;\r\n    }\r\n\r\n    if(this.vX > -1 && this.vX < 1){\r\n      this.vX = 0;\r\n    }else{\r\n      this.vX = clamp((this.vX * DRAG_X), -this.props.personality.maxVx, this.props.personality.maxVx);\r\n      // this.vX *= DRAG_X;\r\n    }\r\n\r\n    //- check for sitting on ground, staying in container\r\n    const newY = this.state.posY + this.vY * timePerc;\r\n    if(newY >= this.state.maxY){\r\n      this.vY = 0;\r\n    }\r\n\r\n    const newX = this.state.posX + this.vX * timePerc;\r\n    if(newX >= this.state.maxX){\r\n      this.vX = 0;\r\n    }else if(newX < this.state.minX){\r\n      this.vX = 0;\r\n    }\r\n\r\n    const clampedX = clamp(newX, this.state.minX, this.state.maxX);\r\n    // const clampedY = clamp(newY, this.state.minY, this.state.maxY);\r\n    //- dont clamp top so they can jump real high\r\n    const clampedY = Math.min(newY, this.state.maxY);\r\n    \r\n    this.attemptToUpdatePosition({\r\n      posX: clampedX,\r\n      posY: clampedY,\r\n      isOnGround: clampedY >= this.state.maxY\r\n    });\r\n  }\r\n\r\n  attemptToUpdatePosition(newStateObj){\r\n    for(let key in newStateObj){\r\n      if(this.state[key] !== newStateObj[key]){\r\n        this.setState(newStateObj);\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  //- recalc pet position when window changes size, when pets change, etc\r\n  recalcMaxBounds(resetPetPosition){\r\n    const spriteInfo = this.props.animation?.spriteInfo || null;\r\n    const cageObj = this.props.activeCage;\r\n    const sceneType = this.props.activeSceneType;\r\n\r\n    if(spriteInfo && cageObj){\r\n      const spriteScale = spriteInfo.scale * global.spriteScale;\r\n      const spriteSize = spriteInfo.cells.map(s => s * spriteScale);\r\n\r\n\r\n      // const containerWidth = cageObj.width;\r\n      // const containerHeight = cageObj.height;\r\n      const containerWidth = this.props.containerWidth;\r\n      const containerHeight = this.props.containerHeight;\r\n\r\n      let adjustedWidth;\r\n      let adjustedHeight;\r\n      \r\n      if(isNaN(cageObj.width) && cageObj.width.indexOf('%') > -1){\r\n        adjustedWidth = (Number(cageObj.width.split('%')[0]) / 100) * containerWidth;\r\n      }else{\r\n        adjustedWidth =  cageObj.width;\r\n      }\r\n\r\n      if(isNaN(cageObj.height) && cageObj.height.indexOf('%') > -1){\r\n        adjustedHeight = (Number(cageObj.height.split('%')[0]) / 100) * containerHeight;\r\n      }else{\r\n        adjustedHeight =  cageObj.height;\r\n      }\r\n      \r\n      let cssX;\r\n      let cssY;\r\n      if(sceneType === 'responsive'){\r\n        let adjustedX = cageObj.x + (adjustedWidth / 2);\r\n        let adjustedY = cageObj.y + (adjustedHeight / 2);\r\n\r\n        cssX = `${adjustedX}px`;\r\n        cssY = `${adjustedY}px`;\r\n      }else if(sceneType === 'static'){\r\n        cssX = `calc(50% + ${cageObj.xCenter}px)`;\r\n        cssY = `calc(50% + ${cageObj.yCenter}px)`;\r\n      }else{\r\n        cssX = `${cageObj.x}px`;\r\n        cssY = `${cageObj.y}px`;\r\n      }\r\n\r\n      let thisWidth = sceneType === 'responsive' ? containerWidth : cageObj.width;\r\n      let thisHeight = sceneType === 'responsive' ? containerHeight : cageObj.height;\r\n\r\n      const petSize = [\r\n        spriteSize[0] + spriteInfo.hitboxOffset[0],\r\n        spriteSize[1] + spriteInfo.hitboxOffset[1]\r\n      ]\r\n\r\n      // console.log(thisWidth, petSize[0])\r\n\r\n      const stateObj = {\r\n        petSize: petSize,\r\n        minX: 0 - spriteInfo.hitboxOffset[0],\r\n        minY: 0 - spriteInfo.hitboxOffset[1],\r\n        maxX: (thisWidth - petSize[0]),\r\n        maxY: (thisHeight - petSize[1] + this.props.activeCage.floor),\r\n        cssX: cssX,\r\n        cssY: cssY,\r\n        adjustedWidth: adjustedWidth,\r\n        adjustedHeight: adjustedHeight,\r\n        adjustedRotation: this.props.activeCage.rotation\r\n      }\r\n\r\n      if(resetPetPosition){\r\n        stateObj.posX = stateObj.maxX / 2\r\n      }\r\n      \r\n      this.setState(stateObj);\r\n    }\r\n  }\r\n\r\n  resetPetPosition(){\r\n    window.setTimeout(() => {\r\n      this.recalcMaxBounds(true)\r\n    },0);\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState){\r\n    // console.log('update', prevState, this.state);\r\n    // global.activePet = this;\r\n    if(prevProps.activePetId !== this.props.activePetId){\r\n      this.resetPetPosition();\r\n      this.setState({ debugDraws: [] });\r\n      this.petBrain.setPersonality(this.props.personality);\r\n    }\r\n    if(prevProps.containerWidth !== this.props.containerWidth || prevProps.containerHeight !== this.props.containerHeight){\r\n      this.recalcMaxBounds();\r\n    }\r\n    if(!prevState.isOnGround && this.state.isOnGround){\r\n      this.props.removeActivity('JUMPING');\r\n    }\r\n\r\n    if(prevProps.behavior !== 'DEAD' && this.props.behavior === 'DEAD'){\r\n      this.jumpPet(20)\r\n    }\r\n    // console.log('posX', this.state.posX)\r\n  }\r\n\r\n  checkForPetClicked(x, y){\r\n    const petBox = [\r\n      [ this.state.posX, this.state.posY ],\r\n      [ this.state.posX + this.state.petSize[0], this.state.posY + this.state.petSize[1]]\r\n    ];\r\n\r\n    if(x > petBox[0][0] && x < petBox[1][0] && y > petBox[0][1] && y < petBox[1][1]){\r\n      this.props.clickPet(this.props.petId);\r\n    }\r\n  }\r\n\r\n  onStageClick(e){\r\n    if(ENABLE_DEBUG_CLICKS){\r\n      console.log('CLICK at ', [ e.clientX, e.clientY ]);\r\n      const debugDraws = this.state.debugDraws;\r\n      debugDraws.push([ e.clientX, e.clientY] );\r\n      if(debugDraws.length > MAX_DEBUG_CLICKS){\r\n        debugDraws.splice(0, debugDraws.length - MAX_DEBUG_CLICKS);\r\n      }\r\n      this.setState({debugDraws: debugDraws});\r\n    }\r\n\r\n    if(this.props.activeSceneType === 'responsive'){\r\n      this.checkForPetClicked(e.clientX, e.clientY);\r\n    }\r\n  }\r\n\r\n  getPetOnWall(){\r\n    const wallBuffer = 50;\r\n    if(this.state.posX + wallBuffer >= this.state.maxX){\r\n      return 1;\r\n    }else if(this.state.posX - wallBuffer <= this.state.minX){\r\n      return -1;\r\n    }\r\n\r\n    return 0;\r\n  }\r\n\r\n  render(){\r\n    const { animation, petId } = this.props;\r\n    //- some error happened\r\n\r\n    if(!animation ) return null;\r\n    window.ani = animation;\r\n\r\n    let width = this.state.adjustedWidth;\r\n    let height = this.state.adjustedHeight;\r\n\r\n    // console.log('petX', this.state.posX)\r\n    // console.log('maxX', this.state.maxX)\r\n    // console.log('personality', this.props.personality)\r\n    global.p = this;\r\n\r\n    let drawCommands = [];\r\n    if(animation.type){\r\n      if(animation.spriteInfo.faceDirection){\r\n        drawCommands.push(this.getDrawCommand(animation.type, [ width, height], [ this.state.posX, this.state.posY ], this.state.direction * (animation.spriteInfo.orientation || 1)));\r\n      }else{\r\n        drawCommands.push(this.getDrawCommand(animation.type, [ width, height], [ this.state.posX, this.state.posY ], animation.spriteInfo.orientation || 1));\r\n      }\r\n    }\r\n\r\n    this.state.debugDraws.forEach(dD => {\r\n      drawCommands.push(this.getDrawCommand('DebugDraw', [ width, height], [ dD[0], dD[1] ]));\r\n    })\r\n\r\n    return (\r\n      <S.PetContainer style={{\r\n        left: `${this.state.cssX}`, \r\n        top: `${this.state.cssY}`, \r\n        transform: `rotate(${this.state.adjustedRotation}deg)`\r\n      }} >\r\n        <S.Centerer style={{\r\n          width: width, \r\n          height: height\r\n        }} >\r\n          <AnimationCanvas\r\n            tick={this.state.tick} \r\n            petId={petId} \r\n            containerWidth={width} \r\n            containerHeight={height} \r\n            animation={animation} \r\n            drawCommands={drawCommands} \r\n            onStageClick={e => this.onStageClick(e)}\r\n          />\r\n        </S.Centerer>\r\n      </S.PetContainer>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => ({\r\n  petId: selectActivePetId(state),\r\n  behavior: selectActivePetBehavior(state),\r\n  activities: selectActivePetActivities(state),\r\n  personality: selectActivePetPersonality(state),\r\n  animation: selectActivePetAnimation(state),\r\n  activeCage: selectActiveCage(state),\r\n  activeSceneType: selectActiveSceneType(state)\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => (\r\n  bindActionCreators(\r\n    { addActivity, removeActivity, clickPet },\r\n    dispatch\r\n  )\r\n);\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(Pet);\r\n","export const getAnimation = animationLabel => {\r\n  return A[animationLabel] || null;\r\n}\r\n\r\nconst A = {\r\n  DebugDraw: (ctx, bounds, coords, props) => {\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    const CIRCLE_SIZE = 20;\r\n\r\n    // console.log('doing ', coords[0])\r\n    ctx.arc(coords[0], coords[1], CIRCLE_SIZE, 0, 2 * Math.PI);\r\n    // ctx.arc(0, 0, CIRCLE_SIZE, 0, 2 * Math.PI);\r\n    ctx.globalAlpha = 0.5;\r\n    ctx.fillStyle = 'red';\r\n    ctx.fill();\r\n    ctx.lineWidth = 5;\r\n    ctx.strokeStyle = '#000000';\r\n\r\n    ctx.stroke();\r\n    \r\n    ctx.restore();\r\n  },\r\n  SpinSquare: (ctx, bounds, pos, direction, props) => {\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.clearRect(0, 0, bounds[0], bounds[1]);\r\n    ctx.translate(bounds[0] / 2, bounds[1] / 2);\r\n    ctx.rotate((props.tick * Math.PI) / 180);\r\n    ctx.fillStyle = '#4397AC';\r\n    ctx.fillRect(\r\n      -bounds[0] / 4,\r\n      -bounds[1] / 4,\r\n      bounds[0] / 2,\r\n      bounds[1] / 2\r\n    );\r\n    ctx.restore();\r\n  },\r\n  SpinSquare2: (ctx, bounds, pos, direction, props) => {\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.clearRect(0, 0, bounds[0], bounds[1]);\r\n    ctx.translate(bounds[0] / 2, bounds[1] / 2);\r\n    ctx.rotate((-props.tick * Math.PI) / 45);\r\n    ctx.fillStyle = '#ffffff';\r\n    ctx.fillRect(\r\n      -bounds[0] / 4,\r\n      -bounds[1] / 4,\r\n      bounds[0] / 2,\r\n      bounds[1] / 2\r\n    );\r\n    ctx.restore();\r\n  },\r\n  Sprite_Still: (ctx, bounds, pos, direction, props) => {\r\n    if(!props.sprite) return;\r\n\r\n    const cCoords = getStillCellCoords(props.spriteInfo, props.spriteInfo.frame);\r\n\r\n    let coords = [0, 0];\r\n    if(pos && pos.length === 2){\r\n      coords = pos;\r\n    }\r\n\r\n    const s = (props.spriteInfo.scale || 1) * (global.spriteScale || 1);\r\n    const x = coords[0];\r\n    const y = coords[1];\r\n    const sW = cCoords.w * s;\r\n    const sH = cCoords.h * s;\r\n\r\n    ctx.save();\r\n    ctx.clearRect(0, 0, bounds[0], bounds[1]);\r\n    if(direction === -1){\r\n      ctx.translate(sW, 0);\r\n    }\r\n    ctx.scale(direction, 1);\r\n    ctx.drawImage(\r\n      props.sprite, \r\n      cCoords.x, \r\n      cCoords.y, \r\n      cCoords.w, \r\n      cCoords.h, \r\n      x * direction, \r\n      y, \r\n      sW, \r\n      sH);\r\n    ctx.restore();\r\n  },\r\n  Sprite_Animated: (ctx, bounds, pos, direction, props) => {\r\n    if(!props.sprite) return;\r\n    \r\n    const frame = props.spriteInfo.frame;\r\n    let idx;\r\n    if(frame !== undefined){\r\n      idx = frame;\r\n    }else{\r\n      const frameSkip = props.spriteInfo.speed || 20;\r\n      idx = Math.floor(props.tick / frameSkip)\r\n    }\r\n    const cCoords = getCellCoords(props.spriteInfo, idx);\r\n\r\n    let coords = [0, 0];\r\n    if(pos && pos.length === 2){\r\n      coords = pos;\r\n    }\r\n\r\n    const s = (props.spriteInfo.scale || 1) * (global.spriteScale || 1);\r\n    const x = coords[0];\r\n    const y = coords[1];\r\n    const sW = cCoords.w * s;\r\n    const sH = cCoords.h * s;\r\n\r\n    \r\n    // console.log('sprite is ', props.spriteInfo.frame, idx);\r\n\r\n    ctx.save();\r\n    ctx.clearRect(0, 0, bounds[0], bounds[1]);\r\n    if(direction === -1){\r\n      ctx.translate(sW, 0);\r\n    }\r\n    ctx.scale(direction, 1);\r\n    ctx.drawImage(\r\n      props.sprite, \r\n      cCoords.x, \r\n      cCoords.y, \r\n      cCoords.w, \r\n      cCoords.h, \r\n      x * direction, \r\n      y, \r\n      sW, \r\n      sH);\r\n\r\n      // console.log('overlay sprite', props.overlaySprite)\r\n    props.overlaySprite && ctx.drawImage(\r\n        props.overlaySprite, \r\n        cCoords.x, \r\n        cCoords.y, \r\n        cCoords.w, \r\n        cCoords.h, \r\n        x * direction, \r\n        y, \r\n        sW, \r\n        sH);\r\n    ctx.restore();\r\n  }\r\n}\r\n\r\nconst getStillCellCoords = (sheetData, i) => {\r\n  const c = sheetData.grid[0];\r\n  const r = sheetData.grid[1];\r\n  return {\r\n    x: (i % c) * sheetData.cells[0],\r\n    y: (Math.floor(i / r) % r) * sheetData.cells[1],\r\n    w: sheetData.cells[0],\r\n    h: sheetData.cells[1]\r\n  }\r\n}\r\n\r\nconst getCellCoords = (sheetData, i) => {\r\n  const frames = sheetData.frames;\r\n  const frame = sheetData.frame;\r\n\r\n  let fIdx;\r\n  if(frame !== undefined){\r\n    fIdx = frame;\r\n  }else{\r\n    fIdx = frames[i % frames.length]; \r\n    if(sheetData.dir === -1){\r\n      //- TODO, is this right?\r\n      fIdx = (frames.length - 1) - fIdx;\r\n    }\r\n  }\r\n\r\n  const c = sheetData.grid[0];\r\n\r\n  return {\r\n    x: (fIdx % c) * sheetData.cells[0],\r\n    y: Math.floor(fIdx / c) * sheetData.cells[1],\r\n    w: sheetData.cells[0],\r\n    h: sheetData.cells[1]\r\n  }\r\n}","import { randBetween } from '@util/tools';\r\n\r\nexport const STATUS = {\r\n  BRAINDEAD: 0,\r\n  THINKING: 1,\r\n  DOING: 2\r\n};\r\n\r\nexport const DEFAULT_PERSONALITY = {\r\n  \"thinkRange\": [ 500, 2000 ],\r\n  \"doRange\": [ 500, 2000 ],\r\n  \"jumpChance\": 0\r\n}\r\n\r\nexport const TIME_RANGE = {\r\n  THINKING: [ 200, 2000 ],\r\n  DOING: [ 200, 2000 ]\r\n};\r\n\r\nclass PetBrain {\r\n  constructor(onDoComplete, onThinkComplete) {\r\n    this.onThinkComplete = onThinkComplete;\r\n    this.onDoComplete = onDoComplete;\r\n\r\n    this.timer = null;\r\n    this.status = STATUS.BRAINDEAD;\r\n  }\r\n\r\n  getStatus(){\r\n    return this.name;\r\n  }\r\n\r\n  pullThePlug(){\r\n    this.status = STATUS.BRAINDEAD;\r\n    this.killTimer();\r\n  }\r\n\r\n  startTimer(type, callback, timerDuration = 1000){\r\n    this.killTimer();\r\n    this.timer = window.setTimeout(() => {\r\n      this.onTimerComplete(type, callback);\r\n    }, timerDuration)\r\n  }\r\n\r\n  getPersonality(){\r\n    return this.personality || DEFAULT_PERSONALITY;\r\n  }\r\n\r\n  killTimer(){\r\n    if(this.timer){\r\n      window.clearTimeout(this.timer);\r\n      this.timer = null;\r\n    }\r\n  }\r\n\r\n  getDuration(statusType){\r\n    if(statusType === STATUS.THINKING){\r\n      return randBetween(this.getPersonality().thinkRange);\r\n    }else if(statusType === STATUS.DOING) {\r\n      return randBetween(this.getPersonality().doRange);\r\n    }else{\r\n      console.error(`unexpected duration type \"${statusType}\"`);\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  setPersonality(personality){\r\n    this.personality = { ...this.getPersonality(), ...personality };\r\n  }\r\n\r\n  think(stats, inputs){\r\n    if(inputs.length > 0){\r\n      // right now, handled outside\r\n      // this.pullThePlug();\r\n    }else{\r\n      // console.log('think', this.status)\r\n      if(this.status === STATUS.BRAINDEAD){\r\n        // should i do something?\r\n        if(this.timer){\r\n          // no, busy\r\n        }else{\r\n          this.startDoing();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  startDoing(callback){\r\n    this.status = STATUS.DOING;\r\n    this.startTimer(this.status, callback, this.getDuration(STATUS.DOING));\r\n  }\r\n\r\n  startThinking(callback){\r\n    this.status = STATUS.THINKING;\r\n    this.startTimer(this.status, callback, this.getDuration(STATUS.THINKING));\r\n  }\r\n\r\n  onTimerComplete(type, callback){\r\n    if(type !== this.status){\r\n      console.error('I havent really decided what to use yet, but this is unexpected')\r\n    }\r\n\r\n    switch (this.status){\r\n      case STATUS.THINKING: \r\n        // trigger the DO\r\n        this.onThinkComplete && this.onThinkComplete();\r\n        callback && callback();\r\n        this.startDoing();\r\n        break;\r\n      case STATUS.DOING:\r\n        // trigger the THINK\r\n        this.onDoComplete && this.onDoComplete();\r\n        callback && callback();\r\n        this.startThinking();\r\n      break;\r\n      case STATUS.BRAINDEAD:\r\n        // do nothing, shouldnt be here anyways\r\n        console.error('should not have finished a timer in a different status')\r\n        break;\r\n      default: \r\n        break;\r\n    }\r\n    // move to the next state\r\n    // do the callback\r\n  }\r\n\r\n\r\n}\r\n\r\nexport default PetBrain;\r\n\r\n\r\n/*\r\n  (loop start)\r\n    based on [ input, status ] then [ moods, stats, ]\r\n    decide next: X\r\n    start it:\r\n      - animation\r\n      - activity\r\n  (dynamic time)\r\n    idle animation, \r\n    start think...\r\n  (dynamic time)\r\n    repeat loop\r\n*/","import React, { Component } from 'react';\nimport styled, { css } from 'styled-components';\n\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport { \n  selectActiveScene\n} from '../../../store/selectors';\n\nconst S = {};\nS.Scene = styled.div`\n  position:absolute;\n  top:0;\n  left:0;\n  right:0;\n  bottom:0;\n  z-index:-1;\n\n  .footer-image{\n    width: 100%;\n    height: 100%;\n  }\n\n  ${p => p.type === 'responsive' && css`\n    .background-image{\n      width: 100%;\n      height: 100%;\n      background-size: cover;\n    }\n  `}\n  \n  ${p => p.type === 'static' && css`\n    .background-image{\n      width: 100%;\n      height: 100%;\n      background-repeat: no-repeat;\n      background-position:50% 50%;\n    }\n  `}\n\n`\n\nS.SceneFloor = styled.div`\n  position:absolute;\n  bottom:0;\n  left:0;\n  right:0;\n  height: ${p => `${p.height}px`};\n\n  background-image: url(${p => p.image});\n  background-color: ${p => p.color};\n`\n\nS.SceneBackground = styled.div`\n  position:absolute;\n  top:0;\n  left:0;\n  right:0;\n  bottom:0;\n  z-index:-1;\n\n`\n\nclass Scene extends Component {\n  render(){\n    // console.log('R: Scene');\n    const { \n      activeScene\n    } = this.props;\n\n\n    if(!activeScene){\n      global.alert('ERROR: scene failed to load');\n      return null;\n    }else{\n      const bgImage = activeScene.background.imageUrl ? activeScene.background.imageUrl : null;\n      const type = activeScene.type;\n      /*\n        TODO, using styled components with background-image was causing flickering for some reason (not because of re-render)\n        so for now, just made them non-styled components\n      */\n      return(\n        <S.Scene type={type}>\n          { activeScene.floor && (\n            <S.SceneFloor height={activeScene.floor.height} color={activeScene.floor?.color} >\n              <div className={'footer-image'} style={{ backgroundImage: `url(${activeScene.floor?.imageUrl})`}} />\n            </S.SceneFloor>\n          )}\n          <S.SceneBackground style={{ backgroundColor: activeScene.background.color }} >\n            <div className={'background-image'} style={{ backgroundImage: `url(${bgImage})`, ...activeScene.background.styles }} />\n          </S.SceneBackground>\n        </S.Scene>\n      );\n    }\n\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  activeScene: selectActiveScene(state)\n})\n\nconst mapDispatchToProps = dispatch =>\n  bindActionCreators(\n    {},\n    dispatch\n  )\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Scene)\n\n","import React, { Component } from 'react';\nimport styled from 'styled-components';\nimport { getColor } from '@themes/';\nimport { LilButton } from '@components/ui/button';\n\nconst S = {};\nS.Wrapper = styled.div`\n  position:relative;\n\n  &:hover{\n    .statEventDetail{\n      opacity:1;\n    }\n  }\n`\n\n\nS.CooldownBar = styled.div`\n  width:100%;\n  background-color: ${getColor('grey')};\n  height:5px;\n\n  >div{\n    background-color: ${getColor('blue')};\n    height:100%;\n    transition: width .1s linear;\n  }\n`\n\nclass StatEventButton extends Component {\n  constructor(props){\n    super(props);\n\n    this.cooldownTimer = null;\n\n    this.state = {\n      isCooling: false,\n      coolAt: null\n    }\n  }\n\n  coolDownComplete(){\n    this.setState({\n      isCooling:false,\n      coolAt:null\n    });\n  }\n\n  startCooldown(cooldown){\n    this.setState({\n      isCooling: true,\n      coolAt: new Date().getTime() + cooldown\n    });\n    this.startCooldownTimer(cooldown);\n  }\n\n  startCooldownTimer(cooldown){\n    this.killCooldownTimer();\n    this.cooldownTimer = global.setTimeout(() => {\n      this.coolDownComplete();\n    }, cooldown)\n  }\n\n  killCooldownTimer(){\n    if(this.cooldownTimer){\n      global.clearTimeout(this.cooldownTimer);\n      this.cooldownTimer = null;\n    }\n  }\n\n\n  onButtonClick(statEventObj){\n    // console.log(statEventObj);\n    // console.log('affecting stats: ', statEventObj.statEffects);\n    // console.log('with cooldown', statEventObj.cooldown);\n\n    if(this.state.isCooling){\n      //- if button uses the real disabled, this wont happen\n      console.error('ITEM IS STILL COOLING');\n    }else{\n      if(statEventObj.cooldown){\n        this.startCooldown(statEventObj.cooldown);\n      }\n      this.triggerStatEffects(statEventObj.statEffects);\n    }\n  }\n\n  triggerStatEffects(statEffects){\n    statEffects.forEach(sE => {\n      if(sE.immediate){\n        this.props.onImmediateUpdate(sE.id, sE.immediate);\n      }\n    })\n  }\n\n  renderTooltip(statEventObj){\n\n    let retString ='';\n    statEventObj.statEffects.forEach((sE,idx) => {\n      if(idx > 0) retString += '\\n';\n      retString += `${sE.id}:`;\n      if(sE.immediate){\n        retString += sE.immediate > 0 ? `+${sE.immediate}` : `${sE.immediate}`;\n      }\n    });\n\n    if(statEventObj.cooldown){\n      retString += `\\ncooldown: ${statEventObj.cooldown}`;\n    }\n\n    return retString;\n  }\n\n  getCooldownWidth(cooldown){\n    if(cooldown){\n      if(!this.state.isCooling) return '100%';\n      const percDone = (this.state.coolAt - new Date().getTime()) / cooldown;\n      return Math.round(percDone * 100) + '%'\n    }else{\n      return null;\n    }\n  }\n\n  render(){\n    const { statEventObj } = this.props;\n    const cooldownWidth = this.getCooldownWidth(statEventObj.cooldown);\n\n    return (\n      <S.Wrapper >\n        <LilButton \n          text={statEventObj.label} \n          onClick={e => this.onButtonClick(statEventObj)} \n          isDisabled={this.state.isCooling}\n          tooltip={this.renderTooltip(statEventObj)}>\n        </LilButton>\n        {cooldownWidth && (\n          <S.CooldownBar>\n            <div style={{width: cooldownWidth }} />\n          </S.CooldownBar>\n        )}\n      </S.Wrapper>\n    );\n  }\n}\n\nexport default StatEventButton;\n","\r\nimport { createSelector } from 'reselect';\r\nimport { getPets, getPetDeltaStats, getStatRules, getTaxonomy  } from '@util/pet-store';\r\nimport { getSceneDefinition } from '../../util/item-store';\r\nimport { getPetDefinition } from '../../util/pet-store';\r\nimport { evaluateCondition } from '../../util/tools';\r\n\r\nexport const getNextManifestItem = state => state.data.nextManifestItem || null;\r\nexport const getNextExternalItem = state => state.data.nextExternalItem || null;\r\nexport const getExtrasLoaded = state => state.data.extrasLoaded || 0;\r\nexport const getDataLoadComplete= state => state.data.loadingComplete || 0;\r\n\r\nexport const getSettings = state => state.data.settings;\r\n\r\nexport const getActivePetType = state => state.data.activePetType || null;\r\nexport const getCounter = state => state.data.counter;\r\nexport const getActivePetId = state => state.activePet.id || null;\r\nexport const getForcedBehavior = state => state.activePet.forcedBehavior || null;\r\nexport const getActivePetStats = state => state.activePet.stats || null;\r\nexport const getActivePet = state => state.activePet || null;\r\nexport const getPing = state => state.data.ping || 0;\r\n\r\nexport const selectSettingPingRate = createSelector(\r\n  [getSettings],\r\n  (settings) => {\r\n    if(!settings) return -1;\r\n    return settings.pingRate;\r\n  }\r\n);\r\n\r\nexport const selectSettingVolume = createSelector(\r\n  [getSettings],\r\n  (settings) => {\r\n    if(!settings) return -1;\r\n    return settings.volume;\r\n  }\r\n);\r\n\r\nexport const selectSettingAnimationSpeed = createSelector(\r\n  [getSettings],\r\n  (settings) => {\r\n    if(!settings) return -1;\r\n    return settings.animationSpeed;\r\n  }\r\n);\r\n\r\nexport const selectNextManifestItem = createSelector(\r\n  [getNextManifestItem],\r\n  (nextManifestItem = null) => {\r\n    return nextManifestItem;\r\n  }\r\n);\r\n\r\nexport const selectNextExternalItem = createSelector(\r\n  [getNextExternalItem],\r\n  (nextExternalItem = null) => {\r\n    return nextExternalItem;\r\n  }\r\n);\r\n\r\n\r\nexport const selectIsLoadingComplete = createSelector(\r\n  [getDataLoadComplete],\r\n  (loadingComplete = false) => {\r\n    return loadingComplete || false;\r\n  }\r\n);\r\n\r\nexport const selectActivePets = createSelector(\r\n  [getActivePetType, getPets],\r\n  (activePetType, allPets) => {\r\n    if(!activePetType || !allPets) return [];\r\n\r\n    return allPets.filter(o => o.type === activePetType);\r\n  }\r\n);\r\n\r\n\r\nexport const selectActivePetId = createSelector(\r\n  [getActivePetId],\r\n  (activePetId = null) => {\r\n    return activePetId;\r\n  }\r\n);\r\n\r\nexport const selectActivePetData = createSelector(\r\n  [getActivePetId, getPets],\r\n  (activePetId, allPets) => {\r\n    if(!activePetId || !allPets) return null;\r\n\r\n    const found = allPets.find(p => p.id === activePetId);\r\n    if(found){\r\n      return found;\r\n    }else{\r\n      return null;\r\n    }\r\n  }\r\n);\r\n\r\nexport const selectActivePet = createSelector(\r\n  [selectActivePetData, getActivePet],\r\n  (activePetData, activePet) => {\r\n    if(!activePetData) return null;\r\n\r\n    return {\r\n      ...activePet,\r\n      data: activePetData\r\n    }\r\n  }\r\n);\r\n\r\nexport const selectActiveScene = createSelector(\r\n  [selectActivePetData],\r\n  (activePetData) => {\r\n    if(!activePetData) return null;\r\n    // console.log('selectActiveScene', activePetData);\r\n\r\n    const sceneId = activePetData.scene;\r\n    const scene = getSceneDefinition(sceneId);\r\n    if(scene){\r\n      return scene;\r\n    }else{\r\n      return null;\r\n    }\r\n  }\r\n);\r\n\r\n\r\nexport const selectActiveCage = createSelector(\r\n  [selectActivePetData],\r\n  (activePetData) => {\r\n    if(!activePetData) return null;\r\n\r\n    const sceneId = activePetData.scene;\r\n    const scene = getSceneDefinition(sceneId);\r\n    if(scene && scene.cage){\r\n      return scene.cage;\r\n    }else{\r\n      return null;\r\n    }\r\n  }\r\n);\r\n\r\nexport const selectActiveSceneType = createSelector(\r\n  [selectActivePetData],\r\n  (activePetData) => {\r\n    if(!activePetData) return null;\r\n\r\n    const sceneId = activePetData.scene;\r\n    const scene = getSceneDefinition(sceneId);\r\n    if(scene && scene.type){\r\n      return scene.type;\r\n    }else{\r\n      return null;\r\n    }\r\n  }\r\n);\r\n\r\nexport const selectActiveSceneFloorOffset = createSelector(\r\n  [selectActiveScene],\r\n  (activeScene) => {\r\n    if(!activeScene) return null;\r\n\r\n    return activeScene.cage.floor || 0;\r\n  }\r\n);\r\n\r\nconst getFallbackValue = (graphic, spriteInfo, defaultValue) => {\r\n  if(graphic !== undefined){\r\n    return graphic;\r\n  }else if(spriteInfo !== undefined){\r\n    return spriteInfo;\r\n  }else{\r\n    return defaultValue;\r\n  }\r\n}\r\n\r\nconst createSpriteObj = (label, overlayLabel, graphic, sprite, assetDir = '') => {\r\n  sprite.spriteInfo = sprite.spriteInfo || {};\r\n\r\n  let faceDirection;\r\n  if(graphic.faceDirection !== undefined){\r\n    faceDirection = graphic.faceDirection;\r\n  }else if(sprite.spriteInfo.faceDirection !== undefined){\r\n    faceDirection = sprite.spriteInfo.faceDirection;\r\n  }else{\r\n    faceDirection = true;\r\n  }\r\n\r\n  \r\n  let orientation;\r\n  if(graphic.orientation !== undefined){\r\n    orientation = graphic.orientation;\r\n  }else if(sprite.spriteInfo.orientation !== undefined){\r\n    orientation = sprite.spriteInfo.orientation;\r\n  }else{\r\n    orientation = 1;\r\n  }\r\n\r\n  const imageUrl = `${assetDir}/${sprite.imageUrl}`;\r\n  let overlayUrl = null;\r\n  if(overlayLabel){\r\n    overlayUrl = sprite.overlays?.[overlayLabel];\r\n    if(overlayUrl){\r\n      overlayUrl = `${assetDir}/${overlayUrl}`;\r\n    }\r\n  }\r\n\r\n  return {\r\n    type: sprite.type,\r\n    imageUrl: imageUrl,\r\n    overlayUrl: overlayUrl,\r\n    label: label,\r\n    spriteInfo:{\r\n      speed: graphic.speed || sprite.spriteInfo.speed || 1,\r\n      faceDirection: faceDirection,\r\n      orientation: orientation,\r\n      dir: graphic.dir || sprite.spriteInfo.dir || 1,\r\n      scale: getFallbackValue(graphic.scale, sprite.spriteInfo.scale, 1),\r\n      frames: getFallbackValue(graphic.frames, sprite.spriteInfo.frames),\r\n      frame: getFallbackValue(graphic.frame, sprite.spriteInfo.frame),\r\n      grid: sprite.spriteInfo.grid,\r\n      cells: sprite.spriteInfo.cells,\r\n      hitboxOffset: sprite.spriteInfo.hitboxOffset || [0, 0]\r\n    }\r\n  };\r\n}\r\n\r\n\r\nexport const selectActivePetActivities = createSelector(\r\n  [selectActivePet],\r\n  (activePet) => {\r\n    if(!activePet) return null;\r\n    \r\n    return activePet.activities;\r\n  }\r\n);\r\n\r\nexport const selectActiveDeltaStats = createSelector(\r\n  [selectActivePet, getPing],\r\n  (activePet, ping) => {\r\n    if(!activePet) return null;\r\n\r\n    const statRules = getStatRules(activePet.id);\r\n\r\n    const ds = getDeltaStatsArray(activePet, statRules);\r\n    return ds;\r\n  }\r\n);\r\n\r\nexport const selectActiveSceneStyles = createSelector(\r\n  [selectActiveScene],\r\n  (activeScene) => {\r\n    // console.log('selectActiveSceneStyle', activeScene);\r\n    if(!activeScene) {\r\n      return null;\r\n    }\r\n    return activeScene.styles;\r\n  }\r\n)\r\n\r\n\r\nexport const selectActiveMoods = createSelector(\r\n  [selectActivePet, selectActiveDeltaStats],\r\n  (activePet, deltaStats) => {\r\n    if(!activePet || !deltaStats) return [];\r\n\r\n    let activeMoods = [];\r\n    deltaStats.forEach(stat => {\r\n      if(!stat.effects || stat.effects.length === 0) return;\r\n      const deltaStatActiveMoods = getActiveMoods(stat.effects, stat);\r\n      deltaStatActiveMoods.forEach(dsam => {\r\n        if(activeMoods.indexOf(dsam) === -1) activeMoods.push(dsam);\r\n      })\r\n    });\r\n  \r\n    return activeMoods;\r\n  }\r\n);\r\n\r\nconst evaluateModifier = (whenObj, statObj) => {\r\n  if(evaluateCondition(whenObj.when, statObj)){\r\n    return whenObj.then;\r\n  }else{\r\n    return null;\r\n  }\r\n\r\n}\r\n\r\nconst getActiveMoods = (whenMoods, statObj) => {\r\n\r\n  let matchedMoods = [];\r\n  for(let i = 0; i < whenMoods.length; i++){\r\n    const result = evaluateModifier(whenMoods[i], statObj)\r\n    if(result && matchedMoods.indexOf(result) === -1) matchedMoods.push(result);\r\n  }\r\n\r\n  return matchedMoods;\r\n}\r\n\r\nconst getFullStatEffectObj = (moods, stat) => {\r\n  // console.log(stat, moods);\r\n  const effects = stat.effects || [];\r\n  return effects.map(effect => ({\r\n    when: effect.when,\r\n    then: effect.then,\r\n    mood: {\r\n      id: effect.then,\r\n      ...moods[effect.then]\r\n    }\r\n  }));\r\n}\r\n\r\nconst getDeltaStatsArray = (activePet, statRules) => {\r\n  if(!activePet || !activePet.id) return [];\r\n\r\n  const deltaStats = getPetDeltaStats(activePet.id, new Date().getTime());\r\n\r\n  return deltaStats.map((stat, idx) => {\r\n    const statPercent = (stat.current / stat.max) * 100;\r\n\r\n    // console.log('ac', activePet)\r\n    \r\n    return {\r\n      id: stat.id,\r\n      type: stat.type,\r\n      label: stat.label || stat.id,\r\n      cur: stat.current,\r\n      max: stat.max,\r\n      percent: statPercent,\r\n      fullIsGood: statRules[idx].fullIsGood,\r\n      doesKill: statRules[idx].doesKill,\r\n      fillType: 'fill',\r\n      effects: getFullStatEffectObj(activePet.data.moods, stat)\r\n    }\r\n  });\r\n} \r\n\r\n\r\nexport const evaluateMoods = (whenMoods, currentMoods) => {\r\n  let moodsMatched = [];\r\n\r\n  for(let i = 0; i < whenMoods.length; i++){\r\n    if(currentMoods.indexOf(whenMoods[i]) === -1){\r\n      break;\r\n    }else{\r\n      moodsMatched.push(whenMoods[i]);\r\n    }\r\n  }\r\n\r\n  return moodsMatched.length === whenMoods.length;\r\n}\r\n\r\nexport const evaluateWhen = (when, moodSwingData) => {\r\n  // console.log('evaluateWhen()', when, moodSwingData);\r\n\r\n  switch(when.type){\r\n    case 'moods': {\r\n      if(evaluateMoods(when.moods, moodSwingData.activeMoods)){\r\n        return when;\r\n      }else{\r\n        return null;\r\n      }\r\n    }\r\n    case 'activity': {\r\n      if(moodSwingData.activities.indexOf(when.activity) > -1){\r\n        return when;\r\n      }else{\r\n        return null;\r\n      }\r\n    }\r\n    case 'stat': {\r\n      const statValue = moodSwingData.stats.find(s => s.id === when.stat);\r\n      if(statValue === null){\r\n        console.error(`evaluateWhen(): stat \"${when.stat}\" does not exist for pet`);\r\n        return null;\r\n      }\r\n\r\n      const statResult = evaluateCondition(when.value, statValue);\r\n      if(statResult){\r\n        return when;\r\n      }else{\r\n        // console.log(`....evaluateWhen(): stat \"${when.stat}\" evaluated false for pet`);\r\n        return null;\r\n      }\r\n    }\r\n    case 'status': {\r\n      if(when.isDead === true){\r\n        return moodSwingData.status.isDead === true ? when : null;\r\n      }else if(when.isDead === false){\r\n        return moodSwingData.status.isDead === false ? when : null;\r\n      }else{\r\n        console.warn(`evaluateWhen(): status is missing \"isDead\" attribute`);\r\n        return null;\r\n      }\r\n    }\r\n    default: {\r\n      console.error(`unknown when type \"${when.type}\"`);\r\n      return null;\r\n    }\r\n  }\r\n}\r\n\r\nexport const checkMoodSwingForBehavior = (moodSwings, moodSwingData) => {\r\n  let behavior = null;\r\n  // console.log('checkMoodSwingForBehavior', moodSwingData);\r\n  //- check each swing\r\n  for(let i = 0; i < moodSwings.length; i++){\r\n    const m = moodSwings[i];\r\n\r\n    let whenResult = null;\r\n    if(!m.when || m.when.length === 0){\r\n      whenResult = true;\r\n    }else{\r\n      for(let w = 0; w < m.when.length; w++){\r\n  \r\n        //- if any when is false, skip this swing\r\n        whenResult = evaluateWhen(m.when[w], moodSwingData);\r\n  \r\n        if(!whenResult){\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    if(whenResult){\r\n      behavior = m.then;\r\n      break;\r\n    }else{\r\n      behavior = 'DEFAULT'\r\n    }\r\n  };\r\n  \r\n  return behavior || 'ERROR';\r\n}\r\n\r\nexport const selectActivePetDefinition = createSelector(\r\n  [selectActivePet],\r\n  (activePet) => {\r\n    return getPetDefinition(activePet?.id);\r\n  }\r\n)\r\n\r\nexport const selectActivePetPersonality = createSelector(\r\n  [selectActivePetDefinition],\r\n  (petDef) => {\r\n    return petDef?.personality\r\n  }\r\n)\r\n\r\nexport const selectActivePetBehavior = createSelector(\r\n  [selectActivePet, selectActiveDeltaStats, selectActivePetActivities, selectActiveMoods, getForcedBehavior],\r\n  (activePet, deltaStats, activities, activeMoods, forcedBehavior) => {\r\n    // console.log('selectActivePetBehavior');\r\n    if(!activePet || !activePet.id){\r\n      return 'PET NOT FOUND';\r\n    }\r\n    const petDef = getPetDefinition(activePet.id);\r\n    if(!petDef){\r\n      return 'PET DEFINTION NOT FOUND';\r\n    }\r\n\r\n    if(forcedBehavior){\r\n      return forcedBehavior;\r\n    }else{\r\n      const status = {\r\n        isDead: (activePet && !activePet.isAlive) ? true : false\r\n      }\r\n  \r\n      const newBehavior = checkMoodSwingForBehavior(petDef.moodSwings, {\r\n        status: status,\r\n        stats: deltaStats,\r\n        activities: activities,\r\n        activeMoods: activeMoods\r\n      });\r\n  \r\n      // console.warn('newBehavior is ', newBehavior);\r\n      return newBehavior;\r\n    }\r\n  }\r\n);\r\n\r\nexport const selectActivePetAnimation = createSelector(\r\n  [selectActivePet, selectActivePetBehavior],\r\n  (activePet, behavior) => {\r\n    if(!activePet) return null;\r\n\r\n    const aData = activePet.data;\r\n    const statusObj = aData.behaviors[behavior] || aData.behaviors.DEFAULT;\r\n    const sprites = aData.sprites;\r\n\r\n    if(!statusObj){\r\n      console.error(`Error getting behavior ${behavior}`);\r\n      return null;\r\n    }\r\n    const animIdx = Math.floor(Math.random() * statusObj.animations.length)\r\n    const animationLabel = statusObj.animations[animIdx];\r\n    const overlayLabel = statusObj.overlay || null;\r\n\r\n    const foundAnimation = aData.animations[animationLabel];\r\n    if(foundAnimation){\r\n      const sprite = sprites[foundAnimation.sprite];\r\n\r\n      if(animationLabel && foundAnimation && sprite){\r\n        const spriteObj = createSpriteObj(animationLabel, overlayLabel, foundAnimation, sprite, `${aData.dir}/assets`);\r\n        return spriteObj;\r\n      }else{\r\n        console.error(`Error getting spriteObj for ${animationLabel}`);\r\n        return null;\r\n      }\r\n    }else{\r\n      console.error(`Error getting graphic for ${animationLabel}`);\r\n      return null;\r\n    }\r\n  }\r\n);\r\n\r\nexport const selectPetTaxonomy = createSelector(\r\n  [getTaxonomy],\r\n  (taxonomy = []) => {\r\n    return taxonomy\r\n  }\r\n);","import React, { Component } from 'react';\nimport styled from 'styled-components';\n\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\n\nimport { \n  setActivePetType, \n  setActivePetId,\n  loadExternalItem\n} from '@store/actions';\n\nimport { \n  getActivePetType,\n  getActivePetId,\n  getCounter,\n  selectPetTaxonomy,\n  selectActivePets\n} from '@store/selectors';\n\nimport DropMenu from '@components/ui/dropmenu';\nimport { LilButton } from '@components/ui/button';\n\nconst S = {};\nS.Body = styled.div`\n  ul{\n    padding:0;\n    margin: 0;\n    list-style:none;\n\n    >li{\n      display: inline-block;\n      width:100%;\n\n      &:last-of-type{\n        margin-bottom: 2rem;\n      }\n    }\n  }\n`;\n\n\nclass PetSelection extends Component {\n\n  onSelectPet(id){\n    this.props.history.push({\n      search: `?pet=${id}`\n    });\n    this.props.setActivePetId(id);\n    this.props.onSelectPet(id);\n  }\n\n  showLoadPrompt(){\n    const url = global.prompt('Enter URL to directory containing pet manifest and assets. \\n (use the provided url to load the raccoon externally)', 'http://thomasyancey.com/projects/virtualpet-external/pets/rizzo-raccoon');\n    if(url){\n      this.props.loadExternalItem({ type: 'pets', url: url, id: `external_${url}` });\n    }\n  }\n\n  render(){\n    const { \n      taxonomy,\n      activePetType, \n      activePetId,\n      activeObjects, \n      setActivePetType,\n    } = this.props;\n\n    return(\n      <S.Body>\n        <ul>\n          <li key={0}>\n            <LilButton text={'Load external'} onClick={e => this.showLoadPrompt()} />\n          </li>\n          {taxonomy.map((c, i) => (\n            <li key={`${i}-${c.type}`}>\n              <DropMenu \n                text={c.type} \n                isActive={c.type === activePetType} \n                onClick={() => setActivePetType(c.type)}\n                onItemClick={(payload, e) => this.onSelectPet(payload)}\n                activeId={activePetId}\n                items={activeObjects.map(aO => ({ ...aO, text:aO.name, subText:aO.animal }))}\n                />\n            </li>\n          ))}\n        </ul>\n      </S.Body>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  activePetType: getActivePetType(state),\n  activePetId: getActivePetId(state),\n  counter: getCounter(state),\n  taxonomy: selectPetTaxonomy(state),\n  activeObjects: selectActivePets(state),\n})\n\nconst mapDispatchToProps = dispatch =>\n  bindActionCreators(\n    { setActivePetType, setActivePetId, loadExternalItem },\n    dispatch\n  )\n\nexport default withRouter(connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(PetSelection));\n\n","import React, { Component } from 'react';\nimport styled, { css } from 'styled-components';\nimport { themeGet, shadeColor } from '@themes/';\nimport ReactImageFallback from 'react-image-fallback';\nconst S = {};\nS.MenuLabel = styled.div`\n`\n\nS.DropMenu = styled.div`\n  cursor: pointer;\n  padding: 1rem;\n  font-size:3rem;\n  font-weight: 600;\n  margin-top: 1rem;\n  width:100%;\n\n  overflow:hidden;\n \n  background-color: ${themeGet('color', 'blue')};\n  color: ${themeGet('color', 'white')};\n  text-shadow: .5px .5px 1.5px ${themeGet('color', 'black')};\n\n  border: .2rem solid rgba(255, 255, 255, 0.2);\n  border-radius:1rem;\n  border-color:  rgba(0, 0, 0, .2) rgba(255, 255, 255, .2) rgba(255, 255, 255, .2) rgba(0, 0, 0, .2);\n  box-shadow: -.1rem -.1rem .5rem black;\n\n  &:hover{\n    background-color: ${shadeColor('blue', 10)};\n    text-shadow: 1.5px 1.5px 1.5px ${themeGet('color', 'black')};\n    transform: translate(-1px, -1px);\n    \n    transition: background-color .1s ease-out, transform .1s ease-out;\n  }\n\n  &:active{\n    background-color: ${shadeColor('blue', -10)};\n    transform: translate(.5px, 1px);\n    \n    transition: background-color .1s ease-out, transform .1s ease-out;\n  }\n`;\n\n\n\nS.DropItem = styled.div`\n  padding:2rem 2rem;\n  text-align:right;\n  margin-top: 2rem;\n  max-height:15rem;\n  position:relative;\n\n  >*{\n    :first-child{\n    }\n    :last-child{\n      flex:1;\n    }\n  }\n\n\n  color: ${themeGet('color', 'white')};\n  text-shadow: .5px .5px 1.5px ${themeGet('color', 'black')};\n  background-color: ${themeGet('color', 'blue')};\n\n  border: .2rem solid rgba(255, 255, 255, 0.2);\n  border-color: rgba(255, 255, 255, 0.2) rgba(0, 0, 0, 0.2) rgba(0, 0, 0, 0.2) rgba(255, 255, 255, 0.2);\n  border-radius: 1rem;\n  box-shadow: .1rem .1rem .5rem black;\n\n  transition: background-color .1s ease-out;\n\n  &:hover{\n    background-color: ${shadeColor('blue', 10)};\n    text-shadow: 1.5px 1.5px 1.5px ${themeGet('color', 'black')};\n    transform: translate(-1px, -1px);\n    \n    transition: background-color .1s ease-out, transform .1s ease-out;\n  }\n  \n  &:active{\n    background-color: ${shadeColor('blue', -10)};\n    transform: translate(.5px, 1px);\n    \n    transition: background-color .1s ease-out, transform .1s ease-out;\n  }\n\n  ${p => p.isActive && css`\n    color: ${themeGet('color', 'yellow')};\n    text-shadow: 1px 1px 1.5px ${themeGet('color', 'black')};\n    background-color: ${themeGet('color', 'green')};\n\n    &:hover{\n      background-color: ${shadeColor('green', 10)};\n    }\n  `}\n\n  >div{\n    display:inline-block;\n    vertical-align:middle;\n  }\n`\n\nS.DropItemImgContainer = styled.div`\n  width:106px;\n  height:106px;\n\n  img{\n    box-shadow: ${themeGet('shadow', 'z2')};\n    border: .5rem solid ${themeGet('color', 'white')};\n    border-radius: 50%;\n    width:auto;\n    height:100%;\n  }\n\n`;\n\nS.DropItemLabel = styled.div`\n  width:calc(100% - 106px);\n`;\n\nS.DropItems = styled.div`\n`;\n\n// export const DropMenu = ({ text, isActive, onClick, style, items = [] }) => {\nexport default class DropMenu extends Component {\n\n  constructor(props){\n    super(props);\n\n    this.state = {\n      isOpen: false\n    }\n  }\n\n  onItemClicked(payload, e){\n    if(this.props.onItemClick){\n      this.props.onItemClick(payload, e);\n    }\n  }\n  \n  render(){\n    const { \n      text,\n      isActive, \n      activeId,\n      onClick,\n      style, \n      items\n    } = this.props;\n\n    return (\n      <S.DropMenu isActive={isActive} onClick={(e) => onClick && onClick(e)} style={style} >\n        <S.MenuLabel>{ text }</S.MenuLabel>\n        <S.DropItems>\n          {isActive && items.map((i, idx) => (\n            <DropItem key={idx} isActive={i.id === activeId} thumbnail={`${i.dir}/assets/${i.thumbnail}`} text={i.text} subText={i.subText} onClick={e => this.onItemClicked(i.id, e)} />\n          ))}\n        </S.DropItems>\n      </S.DropMenu>\n    );\n  }\n}\n\n\nexport const DropItem = ({ text, subText, isActive, onClick, style, thumbnail }) => {\n  return (\n    <S.DropItem isActive={isActive} onClick={(e) => onClick && onClick(e)} style={style} >\n      <S.DropItemImgContainer>\n        <ReactImageFallback\n          src={thumbnail}\n          fallbackImage={'ui/unknown_thumbnail.jpg'}\n          initialImage={'ui/unknown_thumbnail.jpg'}\n          alt={text} />\n      </S.DropItemImgContainer>\n      <S.DropItemLabel>\n        <h2>{ text }</h2>\n        <h5>{ subText }</h5>\n      </S.DropItemLabel>\n    </S.DropItem>\n  );\n}\n","import React, { Component } from 'react';\nimport styled, { css } from 'styled-components';\n\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { themeGet, getColor } from '@themes/';\n\nimport { setSettingsValue } from '@store/actions';\n\n//- how often in milliseconds allowed to send action on dragging slider8\nconst SLIDER_THROTTLE = 100;\n\nconst S = {};\nS.Wrapper = styled.div`\n  width: 100%;\n  margin-bottom: 1rem;\n  \n  ${p => p.isDisabled && css`\n    opacity:.2;\n  `}\n`;\n\nS.Label = styled.div`\n  margin-bottom: .5rem;\n`;\n\n\nS.RangeInput = styled.input`\n\n  -webkit-appearance: none;\n  width: 100%;\n  height: 1rem;\n  border-radius: .5rem;\n  background: ${getColor('purple')};\n  outline: none;\n  cursor: pointer;\n  ${p => p.isInverted && css`\n    direction: rtl;\n  `}\n\n  &:disabled{\n    opacity:.5;\n  }\n  \n  &::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    appearance: none;\n    width: 3rem;\n    height: 3rem;\n    border-radius: 50%;\n    background: ${getColor('blue')};\n    box-shadow: ${themeGet('shadow', 'z1')};\n    cursor: grab;\n  }\n\n  &::-moz-range-thumb {\n    width: 3rem;\n    height: 3rem;\n    border-radius: 50%;\n    background: ${getColor('blue')};\n    cursor: grab;\n  }\n`;\n\n\nclass SettingsSlider extends Component {\n  constructor(props){\n    super(props);\n\n    this.throttleTimer = null;\n  }\n\n  killThrottleTimer(){\n    if(this.throttleTimer){\n      global.clearTimeout(this.throttleTimer);\n      this.throttleTimer = null;\n    }\n  }\n\n  startThrottleTimer(time, callback){\n    if(this.throttleTimer) return;\n    \n    this.throttleTimer = global.setTimeout(() => {\n      callback && callback();\n      this.killThrottleTimer();\n    }, time)\n  }\n\n  onChangeSlider(value){\n    this.startThrottleTimer(SLIDER_THROTTLE, () => this.props.setSettingsValue({ id: this.props.id, value: value }));\n  }\n\n  render(){\n    const {\n      title,\n      value,\n      min,\n      max,\n      step,\n      isInverted,\n      isDisabled\n    } = this.props;\n\n    return(\n      <S.Wrapper isDisabled={isDisabled}>\n        <S.Label>              \n          <span>{`${title}:`}</span>\n          <span>{` ${value}`}</span>\n        </S.Label>\n        <S.RangeInput id=\"myRange\" type=\"range\" min={min} max={max} step={step} value={value} disabled={isDisabled} onChange={e => this.onChangeSlider(e.target.value)} isInverted={isInverted}/>\n      </S.Wrapper>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n})\n\nconst mapDispatchToProps = dispatch =>\n  bindActionCreators(\n    { setSettingsValue },\n    dispatch\n  )\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SettingsSlider)\n\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","\r\nimport queryString from 'query-string';\r\n\r\nexport const round = (number, pad) => {\r\n  if(!pad) return Math.round(number);\r\n  \r\n  const rounder = Math.pow(10, pad);\r\n  return Math.round(number * rounder) / rounder;\r\n}\r\n\r\nexport const clamp = (val, min, max) => {\r\n  return Math.min(Math.max(val, min), max);\r\n}\r\n\r\nexport const randBetween = range => {\r\n  return range[0] + (Math.random() * (range[1] - range[0]));\r\n}\r\n\r\nexport const isObj = obj => {\r\n  return typeof obj === 'object' && obj !== null;\r\n}\r\n\r\nexport const convertStringsToNumbersInDeepObj = parsedObj => {\r\n  let retObj = {};\r\n  for(let key in parsedObj){\r\n    const parsedValue = parsedObj[key];\r\n    if(isObj(parsedValue)){\r\n      retObj[key] = convertStringsToNumbersInDeepObj(parsedValue);\r\n    }else{\r\n      if(!isNaN(parsedValue)){\r\n        retObj[key] = Number(parsedValue);\r\n      }else{\r\n        retObj[key] = parsedValue;\r\n      }\r\n    }\r\n  }\r\n  \r\n  return retObj;\r\n}\r\n\r\n/*\r\n  given: \r\n  ('pickle', 'longer-prefix/', {\r\n    items: {\r\n      item2:{\r\n        pickle: \"short.jpg\"\r\n      }\r\n      pickle: 4\r\n    }\r\n  })\r\n\r\n  returns: \r\n  {\r\n    items: {\r\n      item2:{\r\n        pickle: \"longer-prefix/short.jpg\"\r\n      },\r\n      pickle: \"longer-prefix/4\"\r\n    }\r\n  }\r\n*/\r\n\r\nexport const prefixValueInDeepObj = (prefixKey, prefixValue, parsedObj) => {\r\n  let retObj = {};\r\n  for(let key in parsedObj){\r\n    const parsedValue = parsedObj[key];\r\n    if(isObj(parsedValue)){\r\n      retObj[key] = prefixValueInDeepObj(prefixKey, prefixValue, parsedValue);\r\n    }else{\r\n      if(key === prefixKey){\r\n        retObj[key] = `${prefixValue}${parsedValue}`;\r\n      }else{\r\n        retObj[key] = parsedValue;\r\n      }\r\n    }\r\n  }\r\n  \r\n  return retObj;\r\n}\r\n\r\nexport const setObjToCookie = (cookieName, obj) => {\r\n  let cookieValue = '';\r\n  try{\r\n    if(obj){\r\n      cookieValue = JSON.stringify(obj);\r\n    }\r\n  }catch(e){\r\n    console.error('Problem stringifying obj', obj);\r\n  }\r\n  setCookie(cookieName, cookieValue);\r\n}\r\n\r\nexport const getCookieObj = cookieName => {\r\n  const cookieString = getCookie(cookieName);\r\n  if(cookieString){\r\n    try{\r\n      return JSON.parse(cookieString);\r\n    }catch(e){\r\n      console.error('Problem parsing cookieString', cookieString);\r\n      return null;\r\n    }\r\n  }else{\r\n    return null;\r\n  }\r\n}\r\n\r\nexport const setCookie = (cname, cvalue, expires) => {\r\n  // console.log('setCookie');\r\n  var d = new Date();\r\n  d.setTime(d.getTime() + (expires || 3000000000000));\r\n  expires = 'expires='+ d.toUTCString();\r\n  document.cookie = cname + '=' + cvalue + ';' + expires + ';path=/';\r\n}\r\n\r\nexport const getCookie = (cname) => {\r\n  // console.log('getCookie');\r\n  var name = cname + '=';\r\n  var decodedCookie = decodeURIComponent(document.cookie);\r\n  var ca = decodedCookie.split(';');\r\n  for(var i = 0; i <ca.length; i++) {\r\n    var c = ca[i];\r\n    while (c.charAt(0) === ' ') {\r\n      c = c.substring(1);\r\n    }\r\n    if (c.indexOf(name) === 0) {\r\n      return c.substring(name.length, c.length);\r\n    }\r\n  }\r\n  return '';\r\n}\r\n\r\nexport const deleteCookie = cname => {\r\n  setCookie(cname, '', 1);\r\n}\r\n\r\nexport const getSearchObj = (searchString) => {\r\n  return queryString.parse(searchString);\r\n}\r\n\r\nexport const updateAndGetNewQueryString = (key, value, search) => {\r\n  const queryObj = queryString.parse(search);\r\n  queryObj[key] = value;\r\n  return `?${queryString.stringify(queryObj)}`;\r\n}\r\n\r\n\r\n//- https://stackoverflow.com/questions/10970078/modifying-a-query-string-without-reloading-the-page\r\nexport const changeQueryObj = (key, value, searchString) => {\r\n  if (window.history.pushState) {\r\n    const newQueryString = updateAndGetNewQueryString(key, value, searchString);\r\n    const newurl = window.location.protocol + \"//\" + window.location.host + window.location.pathname + newQueryString;\r\n    window.history.pushState({path:newurl},'',newurl);\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\nexport const VALID_CONDITIONS = [ '=', '<', '<=', '>', '>=' ];\r\n\r\nexport const evaluateExpression = (condition, criteria, value) => {\r\n  if(VALID_CONDITIONS.indexOf(condition) === -1){\r\n    console.error(`evaluateExpression(): invalid condition \"${condition}\" from valueString \"${value}\"`);\r\n    return false;\r\n  }\r\n\r\n  // console.log('evaluateExpression()', condition, value, criteria);\r\n\r\n  switch(condition){\r\n    case '=':\r\n      return value === criteria;\r\n    case '<':\r\n      return value < criteria;\r\n    case '<=':\r\n      return value <= criteria;\r\n    case '>':\r\n      return value > criteria;\r\n    case '>=':\r\n      return value >= criteria;\r\n    default: return false;\r\n  }\r\n}\r\n\r\nexport const getConditionDirection = condition => {\r\n  switch(condition){\r\n    case '=':\r\n      return 0;\r\n    case '<':\r\n      return -1;\r\n    case '<=':\r\n      return -1;\r\n    case '>':\r\n      return 1;\r\n    case '>=':\r\n      return 1;\r\n    default: return 0;\r\n  }\r\n}\r\n\r\n/*\r\n  //- convert <=_20% into:\r\n  {\r\n    condition: '<=',\r\n    criteria: '20',\r\n    isPercent: true\r\n  }\r\n*/\r\nexport const parseExpressionString = expressionString => {\r\n  const valueTokens = expressionString.split('_');\r\n  const condition = valueTokens[0];\r\n  const valueCriteria = valueTokens[1];\r\n\r\n  const percentageSplit = valueCriteria.split('%');\r\n  let criteria = percentageSplit[0];\r\n\r\n\r\n  return {\r\n    condition: condition,\r\n    criteria: Number(criteria),\r\n    isPercent: percentageSplit.length > 1,\r\n    direction: getConditionDirection(condition)\r\n  }\r\n}\r\n\r\nexport const evaluateCondition = (expressionString, statValue) => {\r\n  const expression = parseExpressionString(expressionString);\r\n\r\n  let checkValue;\r\n  if(expression.isPercent){\r\n    checkValue = statValue.percent;\r\n  }else{\r\n    checkValue = statValue.cur;\r\n  }\r\n\r\n  if(!expression.condition){\r\n    console.error('evaluateSet(), condition is not defined! ', expressionString);\r\n  }\r\n  const expressionResult = evaluateExpression(expression.condition, expression.criteria, checkValue);\r\n  // console.log('foundExpression:', expressionString, expressionResult);\r\n  return expressionResult;\r\n}","export default __webpack_public_path__ + \"static/media/unfold_more.c42abd3e.svg\";","export default __webpack_public_path__ + \"static/media/unfold_less.7d49cd1e.svg\";","import React, { Component } from 'react';\nimport styled, { css } from 'styled-components';\n\nimport { themeGet, shadeColor } from '@themes/';\nimport ICON_EXPAND from './assets/unfold_more.svg';\nimport ICON_COLLAPSE from './assets/unfold_less.svg';\n\nconst S = {};\n\nS.Base = styled.div`\n  overflow-y:hidden;\n  border-bottom: .5rem solid;\n  box-shadow: 2px 2px 2px black;\n\n  background-color: ${shadeColor('white', 0)};\n  transition: background-color .5s, color .5s;\n\n  &:hover{\n    background-color: ${themeGet('color', 'green')};\n    transition: background-color .5s, color .5s;\n  }\n  color: ${themeGet('color', 'black')};\n`;\n\nS.Header = styled.div`\n  padding: 2rem 3rem;\n  display:flex;\n  align-items:center;\n  cursor:pointer;\n\n  img{\n    width: 30px;\n  }\n  h2{\n    flex:1;\n    color: ${themeGet('color', 'black')};\n    text-shadow: .1px .1px .5px ${themeGet('color', 'black')};\n  }\n\n  &:hover{\n    h2{\n      text-shadow: .25px .25px 1.5px ${themeGet('color', 'black')};\n    }\n  }\n`;\n\nS.Body = styled.div`\n  padding: 0 3rem;\n  max-height:0;\n  ${p => p.isOpen && css`\n    max-height: none;\n  `}\n`;\n\n\nclass PanelBase extends Component {\n  constructor(props){\n    super(props);\n\n    this.onPanelClick = this.onPanelClick.bind(this);\n\n    this.state = {\n      isOpen: false\n    }\n  }\n\n  onPanelClick(e){\n    this.setState({ isOpen: !this.state.isOpen });\n  }\n\n\n  render(){\n    return(\n      <S.Base>\n        <S.Header onClick={this.onPanelClick}>\n          <h2>{this.props.label}</h2>\n          {this.state.isOpen ? (\n            <img src={ICON_EXPAND} alt=\"loading\"/>\n          ):(\n            <img src={ICON_COLLAPSE} alt=\"loading\"/>\n          )}\n        </S.Header>\n        <S.Body isOpen={this.state.isOpen}>\n          { this.props.children }\n        </S.Body>\n      </S.Base>\n    );\n  }\n}\n\nexport default PanelBase;\n\n","import React, { Component } from 'react';\nimport styled from 'styled-components';\n\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport { setSettingsValue } from '@store/actions';\nimport { \n  selectSettingPingRate,\n  selectSettingVolume,\n  selectSettingAnimationSpeed\n} from '@store/selectors';\n\nimport SettingsSlider from './settings-slider';\n\nconst S = {};\nS.Body = styled.div`\n  ul{\n    padding:0;\n    margin: 0;\n    list-style:none;\n\n    text-align:left;\n  }\n`;\n\nS.Item = styled.li`\n  display: inline-block;\n  width:100%;\n  margin-bottom: 1rem;\n\n  span:first-of-type{\n    font-weight: bold;\n  }\n\n  span:last-of-type{\n\n  }\n\n  &:last-of-type{\n    margin-bottom: 2rem;\n  }\n`\n\nclass PanelSettings extends Component {\n  constructor(props){\n    super(props);\n\n    this.onPanelClick = this.onPanelClick.bind(this);\n\n    this.state = {\n      isOpen: false\n    }\n  }\n\n  onPanelClick(e){\n    this.setState({ isOpen: !this.state.isOpen });\n  }\n\n\n  render(){\n    const { \n      pingRate,\n      volume,\n      animationSpeed\n    } = this.props;\n\n    const settingsData = [\n      { \n        id: 'pingRate',\n        title: 'Stat Update Speed',\n        min: 50,\n        max: 5000,\n        step: 10, \n        isDisabled: false,\n        isInverted: true,\n        value: pingRate \n      },\n      { \n        id: 'volume',\n        title: 'Volume',\n        min: 0,\n        max: 100,\n        step: 5, \n        isDisabled: true,\n        isInverted: false,\n        value: volume \n      },\n      { \n        id: 'animationSpeed',\n        title: 'Animation Speed',\n        min: 5,\n        max: 1000,\n        step: 1, \n        isDisabled: true,\n        isInverted: true,\n        value: animationSpeed \n      }\n    ]\n\n    return(\n      <S.Body>\n        <ul>\n          { settingsData.map((c, i) => (\n            <S.Item key={i}>\n              <SettingsSlider \n                id={c.id} \n                title={c.title} \n                value={c.value} \n                min={c.min} \n                max={c.max} \n                step={c.step} \n                isDisabled={c.isDisabled}\n                isInverted={c.isInverted}\n              />\n            </S.Item>\n          ))}\n        </ul>\n      </S.Body>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  pingRate: selectSettingPingRate(state),\n  volume: selectSettingVolume(state),\n  animationSpeed: selectSettingAnimationSpeed(state)\n})\n\nconst mapDispatchToProps = dispatch =>\n  bindActionCreators(\n    { setSettingsValue },\n    dispatch\n  )\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(PanelSettings)\n\n","import React, { Component } from 'react';\nimport styled, { css } from 'styled-components';\n\nimport { themeGet, getColor, shadeColor, getBreakpoint } from '@themes/';\n\nimport { LilButton, Button } from '@components/ui/button';\n\nimport PanelBase from './components/panel-base';\nimport PanelPetSelection from './components/panel-petselection';\nimport PanelSettings from './components/panel-settings';\n\nimport { deleteAllData } from '@util/pet-store';\nimport { withRouter } from 'react-router-dom'\n\nrequire('@themes/app.scss');\n\nconst S = {};\nS.Menu = styled.div`\n  position:absolute;\n  top:0;\n  right:0;\n  width:100%;\n  height:100%;\n`;\n\n\nS.MainPanel = styled.div`\n  position:fixed;\n  top:0rem;\n  bottom:0;\n  border-left: 1rem solid ${getColor('white')};\n  box-shadow: ${themeGet('shadow', 'z3')};\n\n\n  @media ${getBreakpoint.mobile_tiny}{\n    max-width: calc(100% - 15rem);\n  }\n  @media ${getBreakpoint.tablet}{\n    max-width: calc(50%);\n  }\n  width:100%;\n\n  padding-right:0;\n  \n\n  ${p => p.isOpen ? \n    css`\n      right:0%;\n      transition:right .2s ease-in;\n    `: \n    css`\n      right:-100%;\n      transition:right .3s ease-in;\n    `\n  }\n`;\nS.PanelContainer = styled.div`\n  width:100%;\n  height:100%;\n  overflow-y:auto;\n`;\n\nS.ResetButton = styled.div`\n  /* position:absolute; */\n  /* right:1rem; */\n  /* bottom:1rem; */\n  button{\n    background-color: ${getColor('black')};\n\n    &:hover{\n      background-color: ${getColor('red')};\n    }\n    &:active{\n      background-color: ${shadeColor('red', -20)};\n    }\n  }\n`\nS.MenuButton = styled.div`\n  z-index:2;\n  position:absolute;\n\n  top:.5rem;\n  right:calc(100% + 2rem);\n`;\n\nS.PanelBg = styled.div`\n  width:100%;\n  height:100%;\n  position:absolute;\n  left:0;\n  right:0;\n  top:0;\n  bottom:0;\n  /* border-radius: 10px 0 0 10px; */\n\n  z-index:-1;\n  background-color: ${shadeColor('black', 0)};\n  opacity:1;\n`\n\nclass MenuPanel extends Component {\n  render(){\n    // console.log('R: Menu', this.props.location);\n    \n    return(\n      <S.Menu id=\"menu\" >\n        <S.MainPanel id=\"main-panel\" isOpen={this.props.isOpen}>\n          <S.MenuButton>\n            <LilButton text={'menu'} onClick={() => this.props.onToggleMenu()}/>\n          </S.MenuButton>\n          <S.PanelContainer>\n            <PanelBase label=\"Pet Selection\">\n              <PanelPetSelection onSelectPet={() => this.props.onToggleMenu(false)} />\n            </PanelBase>\n            <PanelBase label=\"Settings\" >\n              <PanelSettings />\n            </PanelBase>\n            <S.ResetButton>\n              <Button text={'pet'} onClick={() => this.props.history.push(`/pet${this.props.location.search}`)} />\n              <Button text={'editor'} onClick={() => this.props.history.push(`/editor${this.props.location.search}`)} />\n              <Button text={'CLEAR SAVE'} onClick={() => deleteAllData()} style={{backgroundColor: getColor('red')}} />\n            </S.ResetButton>\n          </S.PanelContainer>\n          <S.PanelBg/>\n        </S.MainPanel>\n      </S.Menu>\n    );\n  }\n}\n\nexport default withRouter(MenuPanel);\n\n","import React, { Component } from 'react';\nimport styled from 'styled-components';\nimport { LilButton } from '@components/ui/button';\n\n\nimport Menu from './menu-panel';\n\nconst S = {};\nS.MenuContainer = styled.div`\n  position:fixed;\n  top:0;\n  right:0;\n  z-index:2;\n`;\n\nS.MenuButton = styled.div`\n  position:absolute;\n  right:.5rem;\n  top:.5rem;\n`;\n\nclass MenuController extends Component {\n  constructor(){\n    super();\n\n    this.state = {\n      isOpen: false\n    }\n  }\n\n  onToggleMenu(force){\n    this.setState({\n      isOpen: force !== undefined ? force : !this.state.isOpen\n    });\n  }\n\n  render(){\n    return(\n      <S.MenuContainer id=\"menu-container\" >\n        <S.MenuButton>\n          <LilButton text={'menu'} onClick={() => this.onToggleMenu()}/>\n        </S.MenuButton>\n\n        <Menu isOpen={this.state.isOpen} onToggleMenu={f => this.onToggleMenu(f)}/>\n      </S.MenuContainer>\n    );\n  }\n}\n\nexport default MenuController;\n","import React, { Component } from 'react';\nimport styled, { css } from 'styled-components';\nimport { themeGet, getColor } from '@themes/';\nimport { round, parseExpressionString } from '@util/tools';\n\nconst S = {};\nS.EffectMarker = styled.div`\n  box-shadow: ${themeGet('shadow', 'z3')};\n  position:absolute;\n  height:100%;\n  z-index:1;\n  opacity: .5;\n\n  transition: opacity 1s;\n\n  ${p => p.isActive && css`\n    opacity: 1;\n    transition: opacity 1s;\n  `}\n\n  /* &:nth-child(odd){\n    .effect-label{\n      bottom:100%;\n      border-radius: 1rem 1rem 0 0;\n      border-bottom: 0;\n    }\n  }\n  &:nth-child(even){ */\n    .effect-label{\n      top:100%;\n      border-radius: 0 0 1rem 1rem;\n      border-top: 0;\n    }\n  /* } */\n\n`\n\nS.Stick = styled.div`\n  width:8px;\n  height:100%;\n  opacity:1;\n  margin-left:-4px;\n\n  >*{\n    display:inline-block;\n    width:4px;\n    height:100%;\n  }\n\n  ${p => p.direction === 1 && css`\n    >.left{\n      background-color: ${getColor('white')};\n    }\n    >.right{\n      background-color: ${p => p.color};\n    }\n  `}\n  ${p => p.direction === -1 && css`\n    >.left{\n      background-color: ${p => p.color};\n    }\n    >.right{\n      background-color:  ${getColor('white')};\n    }\n  `}\n`\n\n\nS.Bubble = styled.div`\n  box-shadow: ${themeGet('shadow', 'z3')};\n  border: .3rem solid ${p => p.color};\n  background-color: ${p => p.color};\n  position:absolute;\n\n  white-space: nowrap;\n  font-size: 1rem;\n\n\n  width:3rem;\n  height:2rem;\n\n  overflow:hidden;\n\n  >*{\n    position:absolute;\n    left:0;\n    top:0;\n    width:50%;\n    height:100%;\n\n    &.left{\n    }\n\n    &.right{\n      left:calc(50%);\n    }\n  }\n\n  transform:translateX(-50%);\n\n  ${p => p.direction === 1 && css`\n    >.left{\n      background-color: ${getColor('white')};\n    }\n    >.right{\n      background-color: ${p => p.color};\n    }\n  `}\n  ${p => p.direction === -1 && css`\n\n    >.left{\n      background-color: ${p => p.color};\n    }\n    >.right{\n      background-color: ${getColor('white')};\n    }\n  `}\n  ${p => p.direction === 0 && css`\n    background-color: ${getColor('white')};\n  `}\n`\n\nS.BubbleTip = styled.div`\n\n  ${p => p.isShowing ? css`\n    top:100%;\n    opacity: 1;\n  `:css`\n    top:0%;\n    opacity: 0;\n  `}\n\n  pointer-events: none;\n  position:absolute;\n  background-color: ${p => p.color};\n  border-radius: 1rem;\n  padding: 1rem;\n  box-shadow: ${themeGet('shadow', 'z3')};\n  font-size:1.25rem;\n  left:50%;\n  transform:translateX(-50%);\n\n  margin-top:3rem;\n\n  min-width: 15rem;\n\n  transition: opacity .3s, top .2s;\n`\n\n\n/*\n{\n  id\n  label\n  cur\n  max\n  percent\n  fullIsGood\n  doesKill\n  fillType\n  effects:[\n    {\n      when: \"<=_30%\"\n      then \"MOOD_TINY\"\n    }\n  ]\n}\n*/\nconst parseEffect = (effect, statObj) => {\n  const expressionObj = parseExpressionString(effect.when);\n  // console.log('criteria', expressionObj.criteria, expressionObj.isPercent);\n  // sendQuiet(effect, statObj, expressionObj, true);\n\n\n  let percentVal;\n  if(expressionObj.isPercent){\n    percentVal = expressionObj.criteria;\n  }else{\n    percentVal = round(expressionObj.criteria / statObj.max, 2) * 100;\n  }\n\n  return {\n    label: effect.mood.label,\n    position: `${percentVal}%`,\n    direction: expressionObj.direction\n  }\n}\n\nclass EffectMarker extends Component {\n  constructor(props){\n    super(props);\n\n    this.state = {\n      tooltipShowing: false\n    }\n  }\n\n  onEnterBubble(e){\n    this.setState({\n      tooltipShowing: true\n    });\n  }\n\n  onLeaveBubble(){\n    this.setState({\n      tooltipShowing: false\n    });\n  }\n\n  renderMessage(effect, statLabel, doesKill, fullIsGood, direction){\n    const retMessages = []\n    retMessages.push(\n    <span key=\"1\">\n      {'when '}\n      <strong>{statLabel}</strong>\n      {' is '}\n      <strong>{effect.when}</strong>\n      {', I feel '}\n      <strong>{`${effect.mood.label}`}</strong>\n    </span>);\n    if(doesKill){\n      if(fullIsGood && direction === -1){\n        retMessages.push(<span key=\"2\">{`if i dont have enough `}<strong>{statLabel}</strong>{` i'll die!`}</span>);\n      }else if(!fullIsGood && direction === 1){\n        retMessages.push(<span key=\"2\">{`if i have too much `}<strong>{statLabel}</strong>{` i'll die!`}</span>);\n      }\n    }\n\n    return retMessages;\n  }\n\n  render(){\n    const { effect, statObj, colorObj, isActive } = {...this.props};\n\n    const effectMarker = parseEffect(effect, statObj);\n  \n    let color = getColor('white');\n    const direction = effectMarker.direction;\n    if(direction === 1){\n      color = colorObj.plus;\n    }else if(direction === -1){\n      color = colorObj.minus;\n    }\n\n    return (\n      <S.EffectMarker style={{ left: effectMarker.position }} isActive={isActive} onMouseEnter={(e) => this.onEnterBubble(e)} onMouseLeave={() => this.onLeaveBubble()}>\n        <S.Stick color={color} isActive={isActive} direction={direction}>\n          <div className=\"left\"></div>\n          <div className=\"right\"></div>\n        </S.Stick>\n        <S.Bubble className=\"effect-label\" color={color} isActive={isActive} direction={direction} alt={effectMarker.label} >\n          <div className=\"left\"></div>\n          <div className=\"right\"></div>\n        </S.Bubble>\n\n        <S.BubbleTip color={color} isShowing={this.state.tooltipShowing} >\n          {this.renderMessage(effect, statObj.label, statObj.doesKill, statObj.fullIsGood, direction)}\n        </S.BubbleTip>\n      </S.EffectMarker>\n    );\n  }\n\n}\n\nexport default EffectMarker;\n","import React from 'react';\nimport styled from 'styled-components';\nimport { themeGet, shadeColor, getColor } from '@themes/';\nimport { LilButton } from '@components/ui/button';\nimport { round } from '@util/tools';\nimport EffectMarker from './effect-marker';\n\nconst STAT_AUGMENT_AMOUNT = 15;\n\nconst S = {};\nS.ProgressBar = styled.div`\n  position:relative;\n  margin: 1rem;\n  margin-bottom: 3rem;\n  \n  color: ${themeGet('color', 'black')};\n`\n\nS.Bar = styled.div`\n  position:relative;\n  border:.5rem solid ${themeGet('color', 'white')};\n  border-radius: 1rem;\n  overflow:hidden;\n  padding:.25rem .5rem;\n  text-align:center;\n  background-color: ${themeGet('color', 'white')};\n\n  box-shadow: 0px -2px 4px ${shadeColor('white', -40)};\n`\n\nS.Value = styled.span`\n  position: relative;\n  z-index:1;\n  /* color: white; */\n`\n\nS.Label = styled.div`\n  position:relative;\n  display:inline;\n\n  background-color:${themeGet('color', 'blue')};\n  padding: .25rem 1rem .5rem 1rem;\n  border-radius: 1rem 1rem 0rem 0rem;\n  border: .5rem solid white;\n  margin:0 0 -1rem .5rem;\n  /* color:${themeGet('color', 'black')}; */\n\n  >*{\n    display:inline-block;\n    vertical-align:middle;\n  }\n\n  h4{\n    width:60%;\n    font-size:2rem;\n  display:inline;\n  }\n  div{\n    width:40%;\n  }\n`\n\nS.BarGroup = styled.div`\n  /* allows canvas clicks behind menu elements */\n  /* pointer-events: all; */\n  \n  position:relative;\n  display:flex;\n  flex-direction:column;\n\n  \n  >*{\n    display:inline-block;\n    vertical-align:middle;\n  }\n\n\n  >div{\n    width:100%;\n  }\n  button{\n    position:absolute;\n    z-index:1;\n    border: 5px solid white;\n    box-shadow: none;\n    margin: 0;\n    padding: .2rem 1rem;\n\n    &:first-child{\n      /* background-color: ${themeGet('color', 'red')}; */\n      left:-1rem;\n      bottom: -1rem;\n    }\n    &:last-child{\n      /* background-color: ${themeGet('color', 'green')}; */\n      right:-1rem;\n      bottom: 1rem;\n    }\n  }\n`\n\nS.Bg = styled.div`\n  position:absolute;\n  top:0;\n  left:0;\n  height:100%; \n  transition: width .3s ease-in-out, background-color .5s ease-in-out;\n`\n\nS.EffectMarkers = styled.div`\n  position:absolute;\n  width:100%;\n  height:100%;\n`\n\nconst getAlertType = (fillType, percent, fullIsGood) => {\n  if(fillType === 'empty'){\n    if(percent < 20){\n      return fullIsGood ? 'bad' : 'good';\n    } else if (percent > 80){\n      return fullIsGood ? 'good' : 'bad';\n    }\n  }else if(fillType === 'fill'){\n    if(percent < 20){\n      return fullIsGood ? 'bad' : 'good';\n    } else if (percent > 80){\n      return fullIsGood ? 'good' : 'bad';\n    }\n  }\n\n  return 'neutral';\n}\n\n\nconst getBarColor = (alertType, barStyles) => {\n  return barStyles[alertType] || barStyles['neutral'] || 'white';\n}\n\nconst ProgressBar = ({ statObj, label, isActive, augmentAction, sceneStyles, moods }) => {\n  // console.log('statObj', statObj);\n  const alertType = getAlertType(statObj.fillType, statObj.percent, statObj.fullIsGood);\n  const barColor = getBarColor(alertType, sceneStyles.bars);\n\n  const bgColor_minus = statObj.fullIsGood ? getColor('red') : getColor('green');\n  const bgColor_plus = statObj.fullIsGood ? getColor('green') : getColor('red');\n\n\n  return (\n    <S.ProgressBar style={{ color: sceneStyles.text }}>\n      <S.Label>\n        <h4>{label}</h4>\n      </S.Label>\n      <S.BarGroup>\n        {augmentAction && (<LilButton text={'-'} onClick={e => augmentAction(statObj.id, -STAT_AUGMENT_AMOUNT)} style={{ backgroundColor: bgColor_minus }} />)}\n        <S.EffectMarkers>\n          { statObj.effects.map((effect, idx) => (\n            <EffectMarker key={idx} isOdd={idx % 2} isActive={moods.indexOf(effect.mood.id) > -1} effect={effect} statObj={statObj} colorObj={{ minus: bgColor_minus, plus: bgColor_plus }} />\n          ))}\n        </S.EffectMarkers>\n        <S.Bar isActive={isActive} >\n          <S.Value>{ `${round(statObj.cur)} / ${statObj.max} (${round(statObj.percent)}%)` }</S.Value>\n          <S.Bg \n            style={{ \n              width:`${statObj.percent}%`,\n              backgroundColor: barColor\n            }} \n          />\n        </S.Bar>\n        {augmentAction && (<LilButton text={'+'} onClick={e => augmentAction(statObj.id, STAT_AUGMENT_AMOUNT)} style={{ backgroundColor: bgColor_plus }} />)}\n      </S.BarGroup>\n    </S.ProgressBar>\n  );\n}\n\nexport default ProgressBar;\n","import React, { Component } from 'react';\r\nimport { bindActionCreators } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport styled, { css } from 'styled-components';\r\n\r\nimport { themeGet, getColor, mixin_clearBubble } from '@themes/';\r\n\r\nimport ProgressBar from './components/progress-bar';\r\nimport StatEventButton from './components/stat-event-button';\r\n\r\nimport { LilButton, Button, NotAButton } from '@components/ui/button';\r\n\r\n\r\nimport {\r\n  ping\r\n} from '@store/actions/index';\r\nimport {\r\n  augmentStat,\r\n  forceBehavior,\r\n  resetPet,\r\n  killPet\r\n} from '@store/actions/pet';\r\nimport { \r\n  selectActivePet,\r\n  selectActiveDeltaStats,\r\n  selectActiveSceneStyles,\r\n  selectActivePetBehavior,\r\n  getForcedBehavior,\r\n  selectActivePetActivities,\r\n  selectActiveMoods\r\n} from '@store/selectors';\r\n\r\nconst S = {};\r\nS.Wrapper = styled.div`\r\n  padding: 1rem;\r\n  position:relative;\r\n  ${mixin_clearBubble()}\r\n\r\n  >*{\r\n    /* allows canvas clicks behind menu elements */\r\n    pointer-events: all;\r\n  }\r\n`\r\n\r\nS.StatDisplay = styled.div`\r\n  text-align:right;\r\n`\r\n\r\nS.StatDisplayLabel = styled.span`\r\n  color: ${themeGet('color', 'white')};\r\n  font-size:2rem;\r\n`\r\nS.StatDisplayValue = styled.span`\r\n  color: ${themeGet('color', 'green')};\r\n  margin-left:1rem;\r\n  font-size:3rem;\r\n`\r\n\r\nS.FooterUi = styled.div`\r\n  position:fixed;\r\n  bottom:0;\r\n  right:0;\r\n  width:100%;\r\n`;\r\n\r\nS.EffectsContainer = styled.div`\r\n  position:absolute;\r\n  left:0;\r\n  bottom:0;\r\n`;\r\n\r\nS.Name = styled.div`\r\n  position:absolute;\r\n  right:2rem;\r\n  padding: 1rem 2rem;\r\n  padding-right:4rem;\r\n  bottom:1rem;\r\n  border: 4px solid black;\r\n  \r\n  border-radius:2rem;\r\n  background-color:white;\r\n  color:black;\r\n  text-align:center;\r\n`\r\n\r\nS.Level = styled.div`\r\n  border-radius: 2rem;\r\n  border: 4px solid black;\r\n  padding: 1rem;\r\n  position:absolute;\r\n  right:-1rem;\r\n  top:-50%;\r\n  text-align:right;\r\n\r\n  font-style: bold;\r\n\r\n\r\n  color: ${themeGet('color', 'blue')};\r\n  background-color: ${themeGet('color', 'white')};\r\n`\r\n\r\nS.InfoButton = styled.div`\r\n  position:absolute;\r\n  right: .5rem;\r\n  bottom: .5rem;\r\n  z-index:1;\r\n`\r\n\r\nS.Info = styled.div`\r\n  ${mixin_clearBubble()}\r\n  max-height:500px;\r\n  transition: max-height .5s ease-in-out;\r\n  overflow: hidden;\r\n  opacity:1;\r\n  color: ${p => getColor('black')};\r\n\r\n  padding: 1rem;\r\n  margin: .5rem;\r\n  font-weight: bold;\r\n  width:100%;\r\n\r\n  ${p => !p.showInfo && css`\r\n    width:0;\r\n    max-height:0;\r\n    opacity:0;\r\n    transition: max-height .5s ease-in-out, opacity .2s, width .5s;\r\n    transition-delay: 0s, 0s, .5s;\r\n  `}\r\n`\r\n\r\nconst StatDisplay = ({ statObj }) => {\r\n  return (\r\n    <S.StatDisplay>\r\n      <S.StatDisplayLabel>{statObj.label}</S.StatDisplayLabel>\r\n      <S.StatDisplayValue>{statObj.cur}</S.StatDisplayValue>\r\n    </S.StatDisplay>\r\n  );\r\n};\r\n\r\nclass PetStats extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n      isInfoOpen: false\r\n    }\r\n  }\r\n\r\n  onToggleShowInfo(force){\r\n    this.setState({\r\n      isInfoOpen: force !== undefined ? force : !this.state.isInfoOpen\r\n    });\r\n  }\r\n\r\n  updateStat(id, val){\r\n    console.log('updateStat', id, val)\r\n    this.props.augmentStat(id, val);\r\n    this.props.ping();\r\n  }\r\n\r\n  resetPet(id){\r\n    console.log('resetters')\r\n    this.props.resetPet(id);\r\n    this.props.ping();\r\n  }\r\n\r\n  getDeadStats(deltaStats){\r\n    return deltaStats.filter(ds => {\r\n      if(ds.doesKill){\r\n        // console.log(`${ds.id}, fullIsGood:${ds.fullIsGood}, cur:${ds.cur}, max:${ds.max}`)\r\n        if(ds.fullIsGood && ds.cur === 0){\r\n          return true;\r\n        }else if(!ds.fullIsGood && ds.cur === ds.max){\r\n          return true;\r\n        }\r\n      }\r\n\r\n      return false;\r\n    });\r\n  }\r\n\r\n  checkForDead(deltaStats){\r\n    if(this.getDeadStats(deltaStats).length > 0){\r\n      this.props.killPet(this.props.activePet.id)\r\n    }\r\n  }\r\n\r\n  render(){\r\n    // console.log('R: Info');\r\n    const { \r\n      activePet,\r\n      behavior,\r\n      deltaStats,\r\n      forceBehavior,\r\n      forcedBehavior,\r\n      sceneStyles,\r\n      moods,\r\n      activities\r\n    } = this.props;\r\n    if(!activePet || !sceneStyles) return null;\r\n\r\n    const petData = activePet.data;\r\n    const behaviorIds = Object.keys(petData.behaviors);\r\n    const level = deltaStats.find(ds => ds.id === 'level') ? deltaStats.find(ds => ds.id === 'level').cur : -1;\r\n    const isAlive = activePet.isAlive;\r\n    \r\n    if(isAlive) this.checkForDead(deltaStats);\r\n    const allMoods = Object.keys(petData.moods).map(mKey => ({ id: mKey, label: petData.moods[mKey].label || mKey }));\r\n    return (\r\n      <S.Wrapper>\r\n        {deltaStats.map((s, i) => {\r\n          if(s.type === 'number'){\r\n            return (\r\n              <StatDisplay key={i} statObj={s} />\r\n            );\r\n          }else{\r\n            return (\r\n              <ProgressBar key={i} sceneStyles={sceneStyles} statObj={s} moods={moods} label={s.label} augmentAction={(id, val) => this.updateStat(id, val)}/>\r\n            );\r\n          }\r\n        })}\r\n        {/* <S.ResetContainer> */}\r\n        {/* </S.ResetContainer> */}\r\n        \r\n        <S.InfoButton>\r\n          <LilButton text={'info'} onClick={e => this.onToggleShowInfo()} />\r\n          <LilButton text={'Reset Pet'} onClick={() => this.resetPet(activePet.id)} style={{backgroundColor: getColor('red')}} />\r\n        </S.InfoButton>\r\n        <S.Info showInfo={this.state.isInfoOpen}>\r\n          <p>{'Activities'}</p>\r\n            <NotAButton isActive={activities.indexOf('WALKING') > -1} text={'WALKING'} />\r\n            <NotAButton isActive={activities.indexOf('JUMPING') > -1} text={'JUMPING'} />\r\n            <NotAButton isActive={activities.indexOf('DUCKING') > -1} text={'DUCKING'} />\r\n            <NotAButton isActive={activities.indexOf('EATING') > -1} text={'EATING'} />\r\n            <NotAButton isActive={activities.indexOf('ROAMING') > -1} text={'ROAMING'} />\r\n          <hr/>\r\n          <p>{'Moods'}</p>\r\n            {allMoods.map((mood, idx) => (\r\n              <NotAButton key={idx} isActive={moods.indexOf(mood.id) > -1} text={mood.label} onClick={() => {}} />\r\n            ))}\r\n          <hr/>\r\n          <p>{'Behaviors (click to toggle override)'}</p>\r\n            {behaviorIds.map((aId, idx) => \r\n              {\r\n                return (forcedBehavior === aId) ? (\r\n                  <LilButton key={idx} isActive={behavior === aId} text={aId} onClick={() => forceBehavior(aId)} style={{ backgroundColor: getColor('purple') }}/>\r\n                ):(\r\n                  <LilButton key={idx} isActive={behavior === aId} text={aId} onClick={() => forceBehavior(aId)} />\r\n                )\r\n              }\r\n            )}\r\n          <hr/>\r\n\r\n        </S.Info>\r\n        \r\n        <S.FooterUi>\r\n          <S.EffectsContainer>\r\n            {petData.statEvents && petData.statEvents.map((s,idx) => (\r\n              <StatEventButton key={idx} statEventObj={s} onImmediateUpdate={(stat,val) => this.updateStat(stat,val)} />\r\n            ))}\r\n          </S.EffectsContainer>\r\n          <S.Name>\r\n            <span>{`${petData.name} the ${petData.animal}`}</span>\r\n            <S.Level><span>{level}</span></S.Level>\r\n          </S.Name>\r\n        </S.FooterUi>\r\n      </S.Wrapper>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  activePet: selectActivePet(state),\r\n  deltaStats: selectActiveDeltaStats(state),\r\n  sceneStyles: selectActiveSceneStyles(state),\r\n  behavior: selectActivePetBehavior(state),\r\n  forcedBehavior: getForcedBehavior(state),\r\n  moods: selectActiveMoods(state),\r\n  activities: selectActivePetActivities(state)\r\n})\r\n\r\nconst mapDispatchToProps = dispatch =>\r\n  bindActionCreators(\r\n    {\r\n      augmentStat,\r\n      forceBehavior,\r\n      resetPet,\r\n      ping,\r\n      killPet\r\n    },\r\n    dispatch\r\n  )\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(PetStats)\r\n\r\n","import React, { Component } from 'react';\nimport styled from 'styled-components';\n\nimport Cage from '@scenes/cage';\nimport Info from '@scenes/info';\n\nconst S = {};\nS.Main = styled.div`\n  position:absolute;\n  top:0;\n  right:0;\n  bottom:0;\n  left:0;\n  z-index:1;\n`\n\nS.Stage = styled.section`\n  position:relative;\n  width: 100%;\n  height: 100%;\n\n  padding: .5rem;\n`\n\nS.CageContainer = styled.div`\n  position:absolute;\n  top:0;\n  right:0;\n  bottom:0;\n  left:0;\n  z-index:-1;\n`;\n\nS.InfoContainer = styled.div`\n  /* allow canvas clicks under menu elements */\n  pointer-events:none;\n\n  margin:1rem;\n  z-index:1;\n  margin-top:5rem;\n`;\n\nclass Main extends Component {\n  constructor(props){\n    super(props);\n\n    this.state = {\n      isOpen: false\n    }\n  }\n\n  onToggleMenu(force){\n    this.setState({\n      isOpen: force !== undefined ? force : !this.state.isOpen\n    });\n  }\n\n  render(){\n    return(\n      <S.Main>\n        <S.Stage>\n          <S.InfoContainer  id=\"info-container\">\n            <Info />\n          </S.InfoContainer>\n          <S.CageContainer>\n            <Cage />\n          </S.CageContainer>\n        </S.Stage>\n      </S.Main>\n    );\n  }\n}\n\nexport default Main;\n","import React, { Component } from 'react';\nimport styled from 'styled-components';\nimport { Button, ThemeProvider, createMuiTheme } from '@material-ui/core';\nimport { getColor } from '@themes/';\nimport Cage from '@scenes/cage';\n\nconst S = {};\nS.PetCell = styled.div`\n  border: 5px solid white;\n  height:200px;\n\n  >div{\n    display:inline-block;\n    vertical-align:middle;\n    height:100%;\n  }\n`\n\nS.PetFrame = styled.div`\n  width: 33%;\n  border:1px solid red;\n`;\n\nS.Controls = styled.div`\n  width: 66%;\n  height: 100px;\n  border:1px solid yellow;\n`;\n\nclass PetCell extends Component {\n  render(){\n    return(\n      <S.PetCell>\n        <S.PetFrame>\n            <Cage />\n        </S.PetFrame>\n        <S.Controls>\n          <Button variant=\"contained\" color=\"primary\">This is a button</Button>\n          <Button variant=\"contained\" color=\"primary\">This is a button</Button>\n          <Button variant=\"contained\" color=\"primary\">This is a button</Button>\n        </S.Controls>\n      </S.PetCell>\n    );\n  }\n}\n\nexport default PetCell;\n","import React, { Component } from 'react';\nimport styled from 'styled-components';\nimport { Button, ThemeProvider, createMuiTheme } from '@material-ui/core';\nimport ScopedCssBaseline from '@material-ui/core/ScopedCssBaseline';\nimport blue from '@material-ui/core/colors/blue';\nimport PetCell from './pet-cell';\nimport { getColor } from '@themes/';\n\nconst S = {};\nS.Editor = styled.div`\n  position:absolute;\n  top:0;\n  right:0;\n  bottom:0;\n  left:0;\n  z-index:1;\n`\n\nconst theme = createMuiTheme({\n  palette:{\n    type: 'dark',\n    primary:{\n      // main: getColor('blue')\n      main: blue[500]\n    }\n  },\n});\n\nclass Editor extends Component {\n  render(){\n    return(\n      <ThemeProvider theme={theme}>\n        <ScopedCssBaseline>\n          <S.Editor>\n            <PetCell />\n            <PetCell />\n            <PetCell />\n            <PetCell />\n          </S.Editor>\n        </ScopedCssBaseline>\n      </ThemeProvider>\n    );\n  }\n}\n\nexport default Editor;\n","import React, { useEffect } from 'react';\r\n\r\nconst HookCanvas = ({ onStageClick, canvasWidth, canvasHeight, drawCommands, drawProps, tick }) => {\r\n  const [canvasRef, setCanvasRef] = React.useState(0);\r\n  \r\n  useEffect(() => {\r\n    if(canvasRef){\r\n      drawCommands.forEach(dC => {\r\n        dC(canvasRef, { ...drawProps, tick: tick });\r\n      });\r\n    }\r\n  }, [ tick, canvasRef, drawCommands, drawProps ]);\r\n\r\n  return (\r\n    <canvas\r\n      onClick={onStageClick}\r\n      width={canvasWidth}\r\n      height={canvasHeight}\r\n      ref={node =>\r\n        node ? setCanvasRef(node.getContext('2d')) : null\r\n      }\r\n    />\r\n  );\r\n}\r\n\r\nexport default HookCanvas;","import React, { Component } from 'react';\r\nimport HookCanvas from './hook-canvas';\r\n\r\n/*\r\n some based off of this article from Phil Nash https://philna.sh/blog/2018/09/27/techniques-for-animating-on-the-canvas-in-react/\r\n*/\r\nexport default class AnimationCanvas extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.frames = 0;\r\n\r\n    this.state = { \r\n      img: null,\r\n      overlayImg: null,\r\n      loadStarted: false\r\n     };\r\n  }\r\n\r\n  updateImage(imageUrl, overlayUrl){\r\n    if(imageUrl || overlayUrl){\r\n      this.setState({ 'loadStarted': true });\r\n    }\r\n    if(imageUrl){\r\n      let img = new Image();\r\n      img.src = imageUrl;\r\n\r\n      img.onload = () => {\r\n        this.setState({\r\n          img: img\r\n        });\r\n      };\r\n    }else{\r\n      this.setState({ imageUrl: null })\r\n    }\r\n    \r\n    if(overlayUrl){\r\n      let img = new Image();\r\n      img.src = overlayUrl;\r\n\r\n      img.onload = () => {\r\n        this.setState({\r\n          overlayImg: img\r\n        });\r\n      };\r\n    }else{\r\n      this.setState({ overlayImg: null })\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps){\r\n    const { imageUrl, overlayUrl } = this.props.animation;\r\n    if(this.props.overlayUrl) console.log(this.props.overlayUrl)\r\n    if(imageUrl){\r\n      if(prevProps.animation.imageUrl !== imageUrl || prevProps.animation.overlayUrl !== overlayUrl){\r\n        this.updateImage(imageUrl, overlayUrl);\r\n      }else{\r\n        if(!this.state.img && !this.state.loadStarted){\r\n          this.updateImage(imageUrl, overlayUrl);\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <HookCanvas \r\n        tick={this.props.tick} \r\n        canvasWidth={this.props.containerWidth} \r\n        canvasHeight={this.props.containerHeight}\r\n        onStageClick={this.props.onStageClick}\r\n        drawCommands={ this.props.drawCommands } \r\n        drawProps={{\r\n          sprite: this.state.img,\r\n          overlaySprite: this.state.overlayImg,\r\n          spriteInfo: this.props.animation.spriteInfo,\r\n          direction: this.props.direction\r\n        }}\r\n      />\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n// import App from './routes';\r\nimport AppContainer from '@scenes/app';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport { Provider } from 'react-redux'\r\nimport { HashRouter } from \"react-router-dom\";\r\nimport { ThemeProvider } from 'styled-components'\r\nimport store from './store'\r\nimport theme from '@themes/'\r\nimport Logger, { init as initLogger } from './util/logger';\r\n\r\n\r\nglobal.store = store;\r\ninitLogger(0);\r\nglobal.logger = Logger;\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <HashRouter>\r\n      <ThemeProvider theme={theme}>\r\n        <AppContainer />\r\n      </ThemeProvider>\r\n    </HashRouter>\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","import { createAction } from 'redux-actions';\r\n\r\nexport const setManifest = createAction('SET_MANIFEST');\r\nexport const storeManifestItem = createAction('STORE_MANIFEST_ITEM');\r\nexport const loadExternalItem = createAction('LOAD_EXTERNAL_ITEM');\r\nexport const setSettingsValue = createAction('SET_SETTINGS_VALUE');\r\nexport const setOtherData = createAction('SET_OTHER_DATA');\r\nexport const setActivePetType = createAction('SET_ACTIVE_PET_TYPE');\r\nexport const setActivePetId = createAction('SET_ACTIVE_PET_ID');\r\nexport const ping = createAction('PING');","import React from 'react';\nimport styled, { css } from 'styled-components';\nimport { themeGet, shadeColor } from '../../themes';\n\nconst S = {};\nS.NotAButton = styled.div`\n  color: ${themeGet('color', 'grey')};\n  text-shadow: .5px .5px 1.5px ${themeGet('color', 'black')};\n  /* background-color: ${themeGet('color', 'grey')}; */\n  /* border-radius: 1rem; */\n  /* border: .2rem solid rgba(255, 255, 255, 0.2); */\n\n  display:inline-block;\n\n\n  \n  border: .2rem solid rgba(255, 255, 255, 0.2);\n  border-radius:1rem;\n  border-color:  rgba(0, 0, 0, .2) rgba(255, 255, 255, .2) rgba(255, 255, 255, .2) rgba(0, 0, 0, .2);\n  box-shadow: -.1rem -.1rem .5rem black;\n  background-color: ${themeGet('color', 'black')};\n\n\n  \n  ${p => p.isActive && css`\n    color: ${themeGet('color', 'grey')};\n    text-shadow: .5px .5px .75px ${themeGet('color', 'black')};\n    background-color: ${themeGet('color', 'yellow')};\n  `}\n\n  \n  padding: .5rem 1.5rem;\n  margin: .5rem;\n  font-size: 2rem;\n  font-weight: 600;\n\n  span{\n  }\n`\n\nS.Button = styled.button`\n  cursor:pointer;\n  position:relative;\n\n  pointer-events: all;\n  outline:0;\n  \n  border:none;\n  border-radius: 1rem;\n\n  font-size:3rem;\n\n  color: ${themeGet('color', 'white')};\n  text-shadow: .5px .5px 1.5px ${themeGet('color', 'black')};\n  background-color: ${themeGet('color', 'blue')};\n\n  border: .2rem solid rgba(255, 255, 255, 0.2);\n  border-color: rgba(255, 255, 255, 0.2) rgba(0, 0, 0, 0.2) rgba(0, 0, 0, 0.2) rgba(255, 255, 255, 0.2);\n  border-radius: 1rem;\n  box-shadow: .1rem .1rem .5rem black;\n\n \n  transition: background-color .1s ease-out;\n\n  &:hover{\n    background-color: ${shadeColor('blue', 10)};\n    text-shadow: 1.5px 1.5px 1.5px ${themeGet('color', 'black')};\n    transform: translate(-1px, -1px);\n    \n    transition: background-color .1s ease-out, transform .1s ease-out;\n\n    .button-tooltip{\n      opacity:1;\n      left:100%;\n    }\n  }\n  \n  &:active{\n    /* down state wasnt resetting on buttons that slid out */\n\n    \n    /* background-color: ${shadeColor('blue', -10)}; */\n    /* transform: translate(.5px, 1px); */\n    \n    /* transition: background-color .1s ease-out, transform .1s ease-out; */\n  }\n\n  ${p => p.isDisabled && css`\n    color: ${themeGet('color', 'black')};\n    text-shadow: 1px 1px 1.5px ${themeGet('color', 'black')};\n    background-color: ${themeGet('color', 'grey')};\n\n    &:hover{\n      background-color: ${shadeColor('grey', 10)};\n    }\n  `}\n\n  ${p => p.isActive && css`\n    color: ${themeGet('color', 'yellow')};\n    text-shadow: 1px 1px 1.5px ${themeGet('color', 'black')};\n    background-color: ${themeGet('color', 'green')};\n\n    &:hover{\n      background-color: ${shadeColor('green', 10)};\n    }\n  `}\n`;\n\nS.BigButton = styled(S.Button)`\n  padding: 1rem 2rem;\n  margin: 1rem;\n  font-size:3rem;\n  font-weight: 600;\n`;\n\n\nS.LilButton = styled(S.Button)`\n  padding: .5rem 1.5rem;\n  margin: .5rem;\n  font-size: 2rem;\n  font-weight: 600;\n`;\n\nS.Tooltip = styled.div`\n  z-index:1;\n  opacity:0;\n  left:0%;\n\n  pointer-events:none;\n\n  position:absolute;\n  top:50%;\n  transform: translateY(-50%);\n\n\n  transition: opacity .4s ease-in-out, left .2s ease-in-out;\n  padding:.5rem 1rem;\n\n  color: ${themeGet('color', 'black')};\n  background-color: ${themeGet('color', 'white')};\n\n  border-radius:1rem;\n  margin:1;\n  white-space:pre-line;\n  min-width:auto;\n  max-width:auto;\n\n  font-size: 1.5rem;\n  text-shadow:none;\n  margin-left:1rem;\n`;\n\nconst Tooltip = ({ text }) => {\n  return (\n    <S.Tooltip className=\"button-tooltip\">\n      <p>{text}</p>\n    </S.Tooltip>\n  )\n}\n\nexport const Button = ({ text, isActive, isDisabled, onClick, style, tooltip }) => {\n  return (\n    <S.BigButton isActive={isActive} disabled={isDisabled} isDisabled={isDisabled} onClick={(e) => onClick && onClick(e)} style={style} title={tooltip} >\n      <span>{ text }</span>\n      {tooltip && <Tooltip text={tooltip} />}\n    </S.BigButton>\n  );\n}\n\nexport const LilButton = ({ text, isActive, isDisabled, onClick, style, tooltip }) => {\n  return (\n    <S.LilButton isActive={isActive} disabled={isDisabled} isDisabled={isDisabled} onClick={(e) => onClick && onClick(e)} style={style} title={tooltip}>\n      <span>{ text }</span>\n      {tooltip && <Tooltip text={tooltip} />}\n    </S.LilButton>\n  );\n}\n\nexport const NotAButton = ({ text, isActive, isDisabled, onClick, style }) => {\n  return (\n    <S.NotAButton isActive={isActive} onClick={(e) => onClick && onClick(e)} style={style} >\n      <span>{ text }</span>\n    </S.NotAButton>\n  );\n}\n","import { css } from 'styled-components';\n\nexport const themeGet = (...args) => props => {\n  let current = props.theme;\n  for (const arg of args) {\n    if (!current[arg]) {\n      console.error('[Theming] Could not find', arg, 'in', current); // eslint-disable-line no-console\n      return '';\n    }\n    current = current[arg];\n  }\n  return current;\n};\n\nexport const getColors = (colorId) => {\n  return Object.keys(store.color);\n}\n\nexport const getColor = (colorId) => {\n  return store.color[colorId];\n}\n\nexport const mixin_clearBubble = () => {\n  return css`\n    border: .2rem solid rgba(255, 255, 255, 0.2);\n    border-color: rgba(255, 255, 255, 0.2) rgba(0, 0, 0, 0.2) rgba(0, 0, 0, 0.2) rgba(255, 255, 255, 0.2);\n    border-radius: 1rem;\n    box-shadow: .1rem .1rem .5rem black;\n  `;\n}\n\nexport const mixin_textStroke = (thickness, spread, color) => {\n  return css`\n    text-shadow:  -${thickness} -${thickness} ${spread} ${color},\n                  ${thickness} -${thickness} ${spread} ${color},\n                  -${thickness} ${thickness} ${spread} ${color},\n                  ${thickness} ${thickness} ${spread} ${color},\n                  -${thickness} -${thickness} ${spread} ${color},\n                  ${thickness} -${thickness} ${spread} ${color},\n                  -${thickness} ${thickness} ${spread} ${color},\n                  ${thickness} ${thickness} ${spread} ${color},\n                  -${thickness} -${thickness} ${spread} ${color},\n                  ${thickness} -${thickness} ${spread} ${color},\n                  -${thickness} ${thickness} ${spread} ${color},\n                  ${thickness} ${thickness} ${spread} ${color},\n                  -${thickness} -${thickness} ${spread} ${color},\n                  ${thickness} -${thickness} ${spread} ${color},\n                  -${thickness} ${thickness} ${spread} ${color},\n                  ${thickness} ${thickness} ${spread} ${color};\n  `;\n}\n\n\nconst store = {\n  color:{\n    black: '#000000',\n    grey: '#373737',\n    grey_light: '#A39F8E',\n    white: '#fef8dd',\n    blue: '#1fb9f3',\n    green: '#51f249',\n    yellow: '#fff249',\n    red: '#F55658',\n    purple: '#6b1ff3'\n  },\n  shadow:{\n    z1: '-0.1rem 0.1rem .25rem .1rem rgba(0,0,0,0.16)',\n    z2: '-0.1rem 0.1rem .25rem .1rem rgba(0,0,0,0.36)',\n    z3: '-.2rem .5rem 1rem .2rem rgba(0,0,0,.36)'\n  },\n  value:{\n    headerHeight: '7.5rem',\n    menuWidth: '12rem'\n  },\n  mixins:{},\n  breakpoints:{\n    mobile_tiny: '300px',\n    mobile_medium: '400px',\n    mobile_large: '500px',\n    tablet: '768px',\n    desktop: '1024px'\n  }\n}\n\n/* https://jsramblings.com/how-to-use-media-queries-with-styled-components/ */\nconst breakpoints = {\n  mobile_tiny: '300px',\n  mobile_medium: '400px',\n  mobile_large: '500px',\n  tablet: '768px',\n  desktop: '1024px'\n}\n\nexport const getBreakpoint = {\n  mobile_tiny: `(min-width: ${breakpoints.mobile_tiny})`,\n  mobile_medium: `(min-width: ${breakpoints.mobile_medium})`,\n  mobile_large: `(min-width: ${breakpoints.mobile_large})`,\n  tablet: `(min-width: ${breakpoints.tablet})`,\n  desktop: `(min-width: ${breakpoints.desktop})`\n};\n\n\n/* from pablo on https://stackoverflow.com/questions/5560248/programmatically-lighten-or-darken-a-hex-color-or-rgb-and-blend-colors */\nexport const shadeColor = (colId, percent) => {\n  var color = store.color[colId] || colId;\n\n  var R = parseInt(color.substring(1,3),16);\n  var G = parseInt(color.substring(3,5),16);\n  var B = parseInt(color.substring(5,7),16);\n\n  R = parseInt(R * (100 + percent) / 100);\n  G = parseInt(G * (100 + percent) / 100);\n  B = parseInt(B * (100 + percent) / 100);\n\n  R = (R<255)?R:255;  \n  G = (G<255)?G:255;  \n  B = (B<255)?B:255;  \n\n  var RR = ((R.toString(16).length===1)?\"0\"+R.toString(16):R.toString(16));\n  var GG = ((G.toString(16).length===1)?\"0\"+G.toString(16):G.toString(16));\n  var BB = ((B.toString(16).length===1)?\"0\"+B.toString(16):B.toString(16));\n\n  return \"#\"+RR+GG+BB;\n}\nexport default store;","/* simple data handler for all the pre-parsed pet information that doesnt change */\r\nimport { clamp, getCookieObj, setObjToCookie, deleteCookie, convertStringsToNumbersInDeepObj } from './tools';\r\n\r\nconst SAVE_SCHEMA_VERSION = 5;\r\n\r\nexport const DEFAULT_PERSONALITY = {\r\n  \"thinkRange\": [ 200, 2000 ],\r\n  \"doRange\": [ 200, 2000 ],\r\n  \"jumpChance\": 0.01,\r\n  \"jumpForce\": 0.8,\r\n  \"xForce\": 1.0,\r\n  \"yForce\": 1.0,\r\n  \"maxVx\": 2.0\r\n}\r\n\r\nconst store = {\r\n  pets:[],\r\n  taxonomy: []\r\n}\r\n\r\nexport const getPets = () => {\r\n  return store.pets;\r\n}\r\n\r\nexport const getPetDefinition = petId => {\r\n  return store.pets.find(p => p.id === petId) || null;\r\n}\r\n\r\n/*\r\nTAXONOMY EXAMPLE\r\nallTypes: [\r\n  {\r\n    type: 'wildlife',\r\n    pets: [\r\n      {\r\n        id:'wildlife-billybeaver',\r\n        label:'Billy the Beaver'\r\n      }\r\n    ]\r\n  }\r\n]\r\n*/\r\n\r\nexport const getTaxonomy = () => {\r\n  return store.taxonomy;\r\n}\r\n\r\n//- right now this doesnt need to be dynamic, so its run on load one time and stored to easy access variable\r\nexport const gatherTaxonomy = (pets) => {\r\n  let allPetTypes = [];\r\n  pets.forEach(p => {\r\n    let foundTypeIndex = allPetTypes.findIndex(t => t.type === p.type);\r\n    if(foundTypeIndex > -1){\r\n      const foundType = allPetTypes[foundTypeIndex];\r\n      foundType.pets.push({ id: p.id, label: p.name });\r\n\r\n      allPetTypes[foundTypeIndex] = foundType;\r\n    }else{\r\n      allPetTypes.push({\r\n        type: p.type,\r\n        pets:[]\r\n      });\r\n    }\r\n  });\r\n\r\n  return allPetTypes;\r\n}\r\n\r\nexport const addToTaxonomy = (petDef, taxonomy) => {\r\n  let foundTypeIndex = taxonomy.findIndex(t => t.type === petDef.type);\r\n  if(foundTypeIndex > -1){\r\n    const foundType = taxonomy[foundTypeIndex];\r\n    foundType.pets.push({ id: petDef.id, label: petDef.name });\r\n    taxonomy[foundTypeIndex] = foundType;\r\n  }else{\r\n    taxonomy.push({\r\n      type: petDef.type,\r\n      pets:[ { id: petDef.id, label: petDef.name }]\r\n    });\r\n  }\r\n\r\n  return taxonomy;\r\n}\r\n\r\nexport const getPetTypes = () => {\r\n\r\n  let allPetTypes = [];\r\n  store.pets.forEach(p => {\r\n    let foundTypeIndex = allPetTypes.findIndex(t => t.type === p.type);\r\n    if(foundTypeIndex > -1){\r\n      const foundType = allPetTypes[foundTypeIndex];\r\n      foundType.pets.push({ id: p.id, label: p.name });\r\n\r\n      allPetTypes[foundTypeIndex] = foundType;\r\n    }else{\r\n      allPetTypes.push({\r\n        type: p.type,\r\n        pets:[]\r\n      });\r\n    }\r\n  });\r\n\r\n  return allPetTypes;\r\n}\r\n\r\nexport const setFromPetManifest = (id, petData, manifest) => {\r\n  // console.log('setFromManifest', id);\r\n  const savedData = getSavedData();\r\n  const savedPet = savedData.pets.find(savedPet => savedPet.id === id);\r\n  const petDef = parsePetData(id, petData, savedPet, savedData, manifest);\r\n  setPetDefinition(id, petDef);\r\n\r\n  store.taxonomy = addToTaxonomy(petDef, store.taxonomy);\r\n}\r\n\r\nconst parseStatEvents = statEvents => {\r\n  return statEvents.map((sE, idx) => {\r\n    let retObj = {\r\n      id: sE.id,\r\n      label: sE.label,\r\n      type: sE.type || 'event',\r\n      cooldown: sE.cooldown ? parseInt(sE.cooldown) : 0,\r\n      statEffects: sE.statEffects.map(sEff => convertStringsToNumbersInDeepObj(sEff))\r\n    }\r\n\r\n    return retObj;    \r\n  })\r\n}\r\n\r\nexport const parsePetData = (id, petDef, savedPet, savedData, manifest) => {\r\n  let defaultBehavior = petDef.behaviors.DEFAULT;\r\n  if(!defaultBehavior){\r\n    try{\r\n      defaultBehavior = petDef.behaviors[Object.keys(petDef.behaviors)[0]];\r\n    }catch(e){\r\n      console.error(`could not autodeclare default status for pet \"${id}\"`);\r\n    }\r\n  }\r\n\r\n  const moodSwings = parseMoodSwings(petDef.moodSwings);\r\n  const statEvents = parseStatEvents(petDef.statEvents || []);\r\n\r\n  const definedStats = petDef.stats;\r\n  let initialStats = [];\r\n\r\n  /* if cookie stats, use them here instead */\r\n  if(savedPet){\r\n    initialStats = mergeStats(definedStats, savedPet.stats, true);\r\n    petDef.isAlive = savedPet.isAlive;\r\n  }else{\r\n    initialStats = definedStats;\r\n    petDef.isAlive = true;\r\n  }\r\n\r\n  petDef.stats_saved = {\r\n    timestamp: savedData.timestamp || new Date().getTime(),\r\n    isAlive: savedData.isAlive,\r\n    stats: initialStats.map(s => formatSavedStatObj(s))\r\n  }\r\n  console.log('personality', petDef.personality)\r\n\r\n  petDef.personality = { ...DEFAULT_PERSONALITY, ...petDef.personality };\r\n\r\n  return {\r\n    ...petDef,\r\n    id: id,\r\n    dir: manifest.url,\r\n    behaviors:{\r\n      ...petDef.behaviors,\r\n      DEFAULT: defaultBehavior\r\n    },\r\n    moodSwings:moodSwings,\r\n    statEvents: statEvents\r\n  }\r\n}\r\n\r\nexport const setPetDefinition = (petId, petDef, saveAfter) => {\r\n  const petIdx = store.pets.findIndex(p => p.id === petId);\r\n  if(petIdx > -1){\r\n    store.pets[petIdx] = petDef;\r\n  }else{\r\n    store.pets.push(petDef);\r\n  }\r\n\r\n  if(saveAfter)  saveAllPetStatsToCookie();\r\n}\r\n\r\nexport const formatStatObj = statObj => {\r\n  return {\r\n    ...statObj,\r\n    value: Number(statObj.value),\r\n    perSecond: Number(statObj.perSecond),\r\n    max: Number(statObj.max)\r\n  }\r\n}\r\n\r\nexport const getDefaultSavedData = () => ({ \r\n  schemaVersion: SAVE_SCHEMA_VERSION,\r\n  timestamp: null, \r\n  pets: []\r\n});\r\n\r\nexport const parseMoodSwings = (moodSwings) => {\r\n  return moodSwings || [];\r\n}\r\n\r\nexport const getSavedData = () => {\r\n  let savedData = getCookieObj('tly_virtualpet');\r\n  if(savedData && (!savedData.schemaVersion || savedData.schemaVersion < SAVE_SCHEMA_VERSION)){\r\n    console.warn(`Schema version ${savedData.schemaVersion} is behind version ${SAVE_SCHEMA_VERSION}, resetting all your data, sorry bubs`);\r\n    deleteCookie('tly_virtualpet');\r\n    savedData = null;\r\n  }\r\n\r\n  return savedData || getDefaultSavedData();\r\n}\r\n\r\nconst mergeStats = (origArray, newArray, overwrite) => {\r\n  const retArray = origArray.slice(0);\r\n  for(let i = 0; i < newArray.length; i++){\r\n    const newStat = newArray[i];\r\n    const matchingStatIdx = retArray.findIndex(oStat => oStat.id === newStat.id);\r\n    if(matchingStatIdx > -1){\r\n      if(overwrite){\r\n        retArray[matchingStatIdx] = { ...retArray[matchingStatIdx], ...newStat };\r\n      }else{\r\n        //- not unique, dont add it\r\n      }\r\n    }else{\r\n      retArray.push(newStat);\r\n    }\r\n  }\r\n\r\n  return retArray;\r\n}\r\n\r\nexport const setPetStoreData = (itemType, data) => {\r\n  return store[itemType] = data;\r\n}\r\nexport const getPetStoreData = (itemType) => {\r\n  return store[itemType];\r\n}\r\n\r\nexport const getStartStats = petId => {\r\n  const petDef = getPetDefinition(petId);\r\n  return petDef?.startStats || [];\r\n}\r\n\r\nexport const getStartStat = (petId, statId) => {\r\n  const startStats = getStartStats(petId);\r\n  return startStats.find(stat => stat.id === statId) || null;\r\n}\r\n\r\nexport const getStatRules = (petId) => {\r\n  const petDef = getPetDefinition(petId);\r\n  if(!petDef) return [];\r\n\r\n  return petDef.stats.map(s => ({\r\n    doesKill: s.doesKill || false,\r\n    fullIsGood: s.fullIsGood,\r\n    max: s.max,\r\n    moods: s.moods || []\r\n  }));\r\n}\r\n\r\n\r\nexport const fancyUpSavedStats = (initialStats, savedStats, timestamp) => {\r\n  const mergedStats = initialStats.map(iS => {\r\n    const savedStat = savedStats.stats.find(sS => sS.id === iS.id);\r\n    return {...iS, ...savedStat}\r\n  });\r\n\r\n\r\n  return {\r\n    timestamp: savedStats.timestamp || timestamp,\r\n    stats: mergedStats.map(mS => formatStatObj(mS))\r\n  }\r\n\r\n\r\n}\r\n\r\nexport const getPetDeltaStats = (petId, timestamp) => {\r\n  const petDef = getPetDefinition(petId);\r\n  const mergedStats = fancyUpSavedStats(petDef.stats, petDef.stats_saved, timestamp)\r\n\r\n  return getDeltaStats(mergedStats, timestamp);\r\n}\r\n\r\nexport const getDeltaStats = (statsObj, timestamp) =>{\r\n  const oldStats = statsObj.stats || [];\r\n  const timeDiff = (timestamp - statsObj.timestamp) / 1000;\r\n\r\n  return oldStats.map(s => {\r\n    return {\r\n      ...s,\r\n      value: s.value,\r\n      max: s.max,\r\n      current: Math.round(clamp(s.value + (s.perSecond * timeDiff), 0, s.max)),\r\n      moods: s.moods\r\n    }\r\n  });\r\n}\r\n\r\nexport const killThisPet = petId => {\r\n  console.log('KILL THIS PET ', petId)\r\n  const petDef = getPetDefinition(petId);\r\n  petDef.isAlive = false;\r\n  setPetDefinition(petId, petDef, true);\r\n}\r\n\r\nexport const augmentPetStat = (petId, statId, augmentValue) => {\r\n  const now = new Date().getTime();\r\n  const stats = getPetDeltaStats(petId, now).slice(0);\r\n  const idx = stats.findIndex(s => s.id === statId);\r\n  const newValue = stats[idx].current + augmentValue;\r\n  stats[idx].current = clamp(newValue, 0, stats[idx].max);\r\n\r\n  saveStats(petId, stats, now);\r\n}\r\n\r\n\r\n/* SAVING */\r\nexport const saveStats = (petId, stats, timestamp) => {\r\n  // console.log('SAVING', petId, timestamp);\r\n  const petDef = getPetDefinition(petId);\r\n  // console.log(petDef)\r\n  // console.error('saving isAlive as ', petDef.isAlive)\r\n  petDef.stats_saved = {\r\n    timestamp: timestamp,\r\n    isAlive: petDef.isAlive,\r\n    stats: stats.map(s => (formatSavedStatObj({ ...s, value: s.current})))\r\n  }\r\n  setPetDefinition(petId, petDef, true);\r\n}\r\n\r\nexport const saveAllPetStatsToCookie = () => {\r\n  console.log('saveAllPetStatsToCookie');\r\n  setObjToCookie('tly_virtualpet', {\r\n    schemaVersion: SAVE_SCHEMA_VERSION,\r\n    timestamp: new Date().getTime(),\r\n    pets: store.pets.map(p => ({\r\n      ...p.stats_saved,\r\n      id: p.id\r\n    }))\r\n  });\r\n}\r\n\r\nexport const formatSavedStatObj = stat => {\r\n\r\n  //- TODO, only NEED to save id and value, however other stuff depends on (and shouldnt depend on) these being in the cookie\r\n\r\n  return {\r\n    id: stat.id,\r\n    value: stat.value,\r\n    type: stat.type,\r\n    label: stat.label,\r\n    perSecond: stat.perSecond,\r\n    max: stat.max,\r\n    fullIsGood: stat.fullIsGood,\r\n    doesKill: stat.doesKill\r\n  }\r\n} \r\n\r\n\r\nexport const saveAllPetStatsToCookieNow = () => {\r\n  store.pets.forEach(p => {\r\n\r\n    const now = new Date().getTime();\r\n    const stats = getPetDeltaStats(p.id, now).slice(0);\r\n\r\n    p.stats_saved = {\r\n      timestamp: now,\r\n      isAlive: p.isAlive,\r\n      stats: stats.map(s => (formatSavedStatObj({ ...s, value: s.current})))\r\n    }\r\n    setPetDefinition(p.id, p);\r\n  });\r\n\r\n  saveAllPetStatsToCookie();\r\n}\r\n\r\n\r\n/* RESETTING */\r\nexport const resetPetState = petId => {\r\n  console.log(`resetting pet \"${petId}\"`);\r\n\r\n  const now = new Date().getTime();\r\n  const petDef = getPetDefinition(petId);\r\n  const definedStats = petDef.stats;\r\n\r\n  petDef.isAlive = true;\r\n  petDef.stats_saved = {\r\n    timestamp: now,\r\n    isAlive: true,\r\n    stats: definedStats.map(s => formatSavedStatObj(s))\r\n  }\r\n  setPetDefinition(petId, petDef)\r\n}\r\n\r\nexport const deleteAllData = () => {\r\n  store.pets = [];\r\n  deleteCookie('tly_virtualpet');\r\n  global.location.reload();\r\n}\r\n\r\n\r\nglobal.petStore = {\r\n  getAllData: () => store,\r\n  deleteAllData: () => deleteAllData(),\r\n  getSavedData: () => getSavedData(),\r\n  getPets: () => getPets(),\r\n  getPetStoreData: (itemType) => getPetStoreData(itemType),\r\n  getPetDefinition: (id) => getPetDefinition(id),\r\n  getPetDeltaStats: (petId, timestamp) => getPetDeltaStats(petId, timestamp)\r\n}\r\n\r\n\r\nexport default store;","import { createAction } from 'redux-actions';\r\n\r\nexport const incrementXp = createAction('INCREMENT_XP');\r\nexport const addActivity = createAction('ADD_ACTIVITY');\r\nexport const removeActivity = createAction('REMOVE_ACTIVITY');\r\nexport const forceBehavior = createAction('FORCE_BEHAVIOR');\r\nexport const resetPet = createAction('RESET_PET');\r\nexport const killPet = createAction('KILL_PET');\r\nexport const clickPet = createAction('CLICK_PET');\r\n\r\nexport const augmentStat = createAction('AUGMENT_STAT', (id, value) => ({\r\n  id: id,\r\n  value: value\r\n}));","/* simple data handler for all the pre-parsed pet information that doesnt change */\r\nimport { convertStringsToNumbersInDeepObj, prefixValueInDeepObj } from './tools';\r\n\r\nconst store = {\r\n  items:[],\r\n  scenes:[]\r\n}\r\n\r\nexport const setFromSceneManifest = (data, manifest) => {\r\n  // console.log('setFromSceneManifest', data, manifest);\r\n  const converted = convertStringsToNumbersInDeepObj(data);\r\n  const complete = prefixValueInDeepObj('imageUrl', `${manifest.url}/assets/`, converted);\r\n\r\n  addSceneDefinition(complete);\r\n}\r\n\r\nexport const addSceneDefinition = (newDefinition) => {\r\n  // console.log('adding new scene definition', newDefinition);\r\n  store.scenes.push(newDefinition);\r\n}\r\n\r\nexport const getSceneDefinition = id => {\r\n  return store.scenes.find(p => p.id === id) || null;\r\n}\r\nexport const getItemDefinition = id => {\r\n  return store.items.find(p => p.id === id) || null;\r\n}\r\nexport const getItems = () => {\r\n  return store.items;\r\n}\r\nexport const getScenes = () => {\r\n  return store.scenes;\r\n}\r\n\r\nglobal.itemStore = {\r\n  getAllData: () => store,\r\n  getItems: () => getItems(),\r\n  getScenes: () => getScenes(),\r\n  getSceneDefinition: (id) => getSceneDefinition(id)\r\n}\r\n\r\n\r\nexport default store;","import React, { Component } from 'react';\r\nimport styled from 'styled-components';\r\n\r\nimport { bindActionCreators } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { themeGet } from '@themes/';\r\nimport { clamp } from '@util/tools';\r\n\r\nimport Pet from '../../components/pet';\r\nimport { \r\n  selectActivePetId\r\n} from '../../store/selectors';\r\n\r\nimport Scene from './components/scene';\r\n\r\nconst S = {};\r\nS.Cage = styled.div`\r\n  position:relative;\r\n\r\n  width:100%;\r\n  height:100%;\r\n\r\n  color: ${themeGet('color', 'blue')};\r\n\r\n  h2{\r\n    color: ${themeGet('color', 'white')};\r\n  }\r\n`\r\n\r\nclass Cage extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.containerRef = React.createRef();\r\n    this.onResize = this.onResize.bind(this);\r\n\r\n    this.state = {\r\n      containerWidth: 500,\r\n      containerHeight: 500\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps){\r\n    //- when the first canavs is rendered, check the page bounds\r\n    if(!prevProps.activePetId && this.props.activePetId){\r\n      this.onResize();\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    global.addEventListener('resize', this.onResize);\r\n    this.onResize();\r\n  }\r\n\r\n  onResize(){\r\n    this.updateCanvasDims();\r\n  }\r\n\r\n  updateCanvasDims(){\r\n    if(this.containerRef.current){\r\n      const squishers = {\r\n        x: clamp((this.containerRef.current.offsetWidth / 1000), .3, 1),\r\n        y: clamp((this.containerRef.current.offsetHeight / 1000), .3, 1)\r\n      }\r\n      // global.spriteScale = squishers.x < squishers.y ? squishers.x : squishers.y;\r\n      this.setState({\r\n        containerWidth: this.containerRef.current.offsetWidth,\r\n        containerHeight: this.containerRef.current.offsetHeight\r\n      })\r\n    }\r\n  }\r\n\r\n  render(){\r\n    const { \r\n      activePetId\r\n    } = this.props;\r\n\r\n    if(!activePetId){\r\n      return null;\r\n    }else{\r\n      return(\r\n        <S.Cage ref={this.containerRef} >\r\n          <Pet \r\n            activePetId={activePetId} \r\n            containerWidth={this.state.containerWidth}\r\n            containerHeight={this.state.containerHeight}\r\n            />\r\n          <Scene />\r\n        </S.Cage>\r\n      );\r\n    }\r\n\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  activePetId: selectActivePetId(state)\r\n})\r\n\r\nconst mapDispatchToProps = dispatch =>\r\n  bindActionCreators(\r\n    {},\r\n    dispatch\r\n  )\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(Cage)\r\n\r\n","const store = {\n  stages: [],\n  stageIdx: 0\n}\n\nconst returnNextStageItem = (manifestStages, nextItemIdx) => {\n  const manifestStageIdx = store.stageIdx;\n\n  if(manifestStageIdx >= manifestStages.length){\n    // console.log(`manifestStageIdx ${manifestStageIdx} is >= ${manifestStages.length}, therefore no stages remain`);\n    return null;\n  }\n\n  const thisStage = manifestStages[manifestStageIdx];\n  const nextItem = thisStage.items[nextItemIdx] || null;\n  if(nextItem){\n    // console.log(`... [${manifestStageIdx}, ${nextItemIdx}]`)\n    return {\n      id: nextItem.id,\n      url: nextItem.url,\n      itemIdx: nextItemIdx,\n      stageIdx: manifestStageIdx\n    };\n  }else{\n    store.stageIdx = store.stageIdx + 1;\n    return returnNextStageItem(manifestStages, 0);\n  }\n}\n\nexport const getNextManifestData = (curItemIdx) => {\n  const nextItemObj = returnNextStageItem(store.stages, curItemIdx);\n  if(nextItemObj){\n    const nextStage = store.stages[nextItemObj.stageIdx]\n\n    return {\n      type: nextStage.type,\n      idx: nextItemObj.itemIdx,\n      id: nextItemObj.id,\n      url: nextItemObj.url\n    }\n  }else{\n    console.log('All manifest items loaded.');\n    // console.log('-------------------------');\n    return null;\n  }\n}\n\nexport const setManifestStages = (stages) => {\n  if(!stages || stages.length === 0){\n    console.error('No manifest items loaded, or there was some error');\n  }\n  store.stages = stages;\n}\n\nglobal.manifestHelper = {\n  getAllData: () => store\n}\n\nexport default store;","\r\nconst store = {\r\n  entries:[-1],  \r\n  level:0,\r\n  logIdx:-1,\r\n};\r\n\r\nexport const init = (logLevel) => {\r\n  store.entries = [];\r\n  store.level = logLevel || 0;\r\n  store.logIdx = -1;\r\n}\r\n\r\nexport const output = (logArgs, level) => {\r\n  if(level === -1) level = store.logLevel;\r\n\r\n  //- if level is 'error' then..\r\n  console.log(...logArgs)\r\n}\r\n\r\nexport const send = (...args) => {\r\n  store.entries.push(args);\r\n  store.logIdx = store.entries.length - 1;\r\n  \r\n  log();\r\n}\r\n\r\nexport const sendQuiet = (...args) => {\r\n  store.entries.push(args);\r\n  store.logIdx = store.entries.length - 1;\r\n}\r\n\r\nexport const log = () => {\r\n  output(store.entries[store.logIdx], store.level);\r\n}\r\n\r\nexport const logPrevious = () => {\r\n  if(store.length === 0 || store.logIdx === -1) {\r\n    return;\r\n  }else if(store.length === 1 || store.logIdx === 0){\r\n    output(store.entries[store.logIdx], store.level);\r\n  }else{\r\n    store.logIdx--;\r\n    output(store.entries[store.logIdx], store.level);\r\n  }\r\n}\r\n\r\nexport const logNext = () => {\r\n  if(store.logIdx === store.entries.length - 1){\r\n    output(store.entries[store.logIdx], store.level);\r\n  }else{\r\n    store.logIdx++;\r\n    output(store.entries[store.logIdx], store.level);\r\n  }\r\n}\r\n\r\nexport const logLast = () => {\r\n  store.logIdx = store.entries.length - 1;\r\n  if(store.logIdx > -1){\r\n    console.log('idx', store.logIdx)\r\n    output(store.entries[store.logIdx], store.level);\r\n  }\r\n}\r\n\r\nconst PublicInterface = {\r\n  init: init,\r\n  send: send,\r\n  sendQuiet: sendQuiet,\r\n  output: output,\r\n  log: log,\r\n  logNext: logNext,\r\n  logPrevious: logPrevious,\r\n  logLast: logLast\r\n}\r\n\r\nexport default PublicInterface;","import { createAction } from 'redux-actions';\n\nexport const setTransitionAction = createAction('SET_TRANSITION');\n\nexport const setTransition = (transitionData) => {\n  return dispatch => {\n    dispatch({\n      type: setTransitionAction,\n      payload: transitionData\n    });\n  }\n};\n\nexport const CHAIN_ACTIONS = 'CHAIN_ACTIONS';\nexport const chainActions = (actionInstructions) => {\n  return dispatch => {\n    executeInstructions(actionInstructions, dispatch);\n  }\n}\n\n//- used by the chainActions action\n//- actionInstructions should be [ { action:function, payload:optional }, ... ]\nexport const executeInstructions = (actionInstructions, dispatch) => {\n  return setTimeout(() => {\n    actionInstructions[0].action(actionInstructions[0].payload)(dispatch);\n    actionInstructions.shift();\n\n    if(actionInstructions.length > 0){\n      executeInstructions(actionInstructions, dispatch);\n    }\n  }, actionInstructions[0].delay || 0);\n}\n\n\nexport const slideTransition = (action, payload, dispatch) => {\n  chainActions([\n    {\n      delay: 0,\n      action: setTransition,\n      payload: {\n        label: 'transitionOut'\n      }\n    },\n    {\n      delay: 1000,\n      action: action,\n      payload: payload\n    },\n    {\n      delay: 1000,\n      action: setTransition,\n      payload: {\n        label: 'transitionIn'\n      }\n    }\n  ])(dispatch);\n}\n","import { \r\n  setManifest,\r\n  storeManifestItem,\r\n  loadExternalItem,\r\n  setActivePetType,\r\n  setActivePetId,\r\n  setSettingsValue,\r\n  ping\r\n} from '../actions';\r\nimport { setTransition } from '../actions/transition';\r\n\r\nimport { handleActions } from 'redux-actions';\r\n\r\nimport { clamp } from '@util/tools';\r\nimport { getPetDefinition, setFromPetManifest } from '@util/pet-store';\r\nimport { setFromSceneManifest } from '@util/item-store';\r\nimport { getNextManifestData, setManifestStages } from '@util/manifest-helper';\r\n\r\nconst VALID_KEYS = [ 'title', 'stages' ];\r\nconst RESTRICT_KEYS = false;\r\nconst DEFAULT_PING_RATE = 1000;\r\nconst DEFAULT_VOLUME = 50;\r\nconst DEFAULT_ANIMATION_SPEED = 30;\r\n \r\nconst initialState = {\r\n  loadingComplete: false,\r\n  settings:{\r\n    pingRate: DEFAULT_PING_RATE,\r\n    volume: DEFAULT_VOLUME,\r\n    animationSpeed: DEFAULT_ANIMATION_SPEED\r\n  },\r\n  title: 'loading',\r\n  customData: null,\r\n  counter: 0,\r\n  activePetType: null,\r\n  activePetId: null,\r\n  ping: 0,\r\n  nextManifestItem: null,\r\n  nextExternalItem: null\r\n}\r\n\r\nexport default handleActions({\r\n  [setManifest.toString()]: (state, action) => {\r\n    const cleanManifestObj = {};\r\n    const parsedData = action.payload;\r\n    const customData = {};\r\n    for(let key in parsedData){\r\n      if(VALID_KEYS.indexOf(key) === -1){\r\n        console.warn(`key supplied in /data.json \"${key}\" is not a valid key`);\r\n        if(!RESTRICT_KEYS) cleanManifestObj[key] = parsedData[key];\r\n      }\r\n      else{\r\n        cleanManifestObj[key] = parsedData[key];\r\n        if(key !== 'stages'){\r\n          customData[key] = parsedData[key];\r\n        }\r\n      }\r\n    }\r\n\r\n    let pingRate = state.settings.pingRate;\r\n    if(parsedData.pingRate !== undefined){\r\n      try {\r\n        if(!isNaN(parsedData.pingRate)){\r\n          pingRate = clamp(parseInt(parsedData.pingRate), 50, 5000);\r\n        }\r\n      }catch(e){\r\n        console.error('there was a problem parsing pingRate');\r\n      }\r\n    }\r\n    \r\n    // console.log('----------------');\r\n    // console.log('starting manifest');\r\n    setManifestStages(parsedData.stages);\r\n    const nextManifestItem = getNextManifestData(0);\r\n\r\n    return {\r\n      ...state,\r\n      nextManifestItem,\r\n      loadingComplete: nextManifestItem === null,\r\n      settings:{\r\n        ...state.settings,\r\n        pingRate\r\n      },\r\n      customData\r\n    }\r\n  },\r\n\r\n  [storeManifestItem.toString()]: (state, action) => {\r\n    // console.log('storeManifestItem', action.payload);\r\n    const { manifest, data } = action.payload;\r\n    // console.log('manifestItem', manifest)\r\n    if(manifest.type === 'pets'){\r\n      setFromPetManifest(manifest.id, data, manifest)\r\n    }else{\r\n      setFromSceneManifest(data, manifest);\r\n    }\r\n\r\n    if(manifest.isExternal){\r\n      return {\r\n        ...state,\r\n        nextExternalItem: null,\r\n      }\r\n    }else{\r\n      const nextManifestItem = getNextManifestData(manifest.idx + 1);\r\n      return {\r\n        ...state,\r\n        nextManifestItem,\r\n        loadingComplete: nextManifestItem === null\r\n      }\r\n    }\r\n  },\r\n\r\n  [setTransition.toString()]: (state, action) => {\r\n    return {\r\n      ...state,\r\n      transitionLabel: action.payload.label\r\n    }\r\n  },\r\n\r\n  [loadExternalItem.toString()]: (state, action) => {\r\n    // console.log('received ', action.payload);\r\n\r\n    return {\r\n      ...state,\r\n      nextExternalItem: {\r\n        id: action.payload.id || action.payload.url,\r\n        idx: 0,\r\n        type: action.payload.type,\r\n        url: action.payload.url,\r\n        isExternal: true\r\n      }\r\n    }\r\n  },\r\n\r\n  [setSettingsValue.toString()]: (state, action) => {\r\n    // console.log('setSettingsValue', action.payload);\r\n    const settingsKey = action.payload.id;\r\n    const storedValue = state.settings[settingsKey];\r\n\r\n    if(storedValue !== undefined && storedValue !== action.payload.value){\r\n      return {\r\n        ...state,\r\n        settings: {\r\n          ...state.settings,\r\n          [settingsKey]: action.payload.value\r\n        }\r\n      }\r\n    }else{\r\n      return state;\r\n    }\r\n  },\r\n\r\n  [setActivePetType.toString()]: (state, action) => {\r\n    // console.log('setActivePetType', action.payload)\r\n    return {\r\n      ...state,\r\n      activePetType: action.payload\r\n    }\r\n  },\r\n\r\n  [setActivePetId.toString()]: (state, action) => {\r\n    //- pet existssetPetDefinitions\r\n    const petDef = getPetDefinition(action.payload);\r\n    if(petDef){\r\n      return {\r\n        ...state,\r\n        activePetId: action.payload\r\n      }\r\n    }else{\r\n      console.error(`Could not get pet definition for id \"${action.payload}\"`);\r\n      return {\r\n        ...state\r\n      }\r\n    }\r\n  },\r\n\r\n  [ping.toString()]: (state) => {\r\n    return {\r\n      ...state,\r\n      ping: state.ping + 1\r\n    }\r\n  },\r\n}, initialState);\r\n","import { \r\n  setActivePetId\r\n} from '../actions';\r\nimport { \r\n  addActivity,\r\n  removeActivity,\r\n  forceBehavior,\r\n  augmentStat,\r\n  resetPet,\r\n  killPet,\r\n  clickPet\r\n} from '../actions/pet';\r\n\r\nimport { handleActions } from 'redux-actions'; \r\nimport { getPetDefinition, augmentPetStat, resetPetState, killThisPet } from '@util/pet-store';\r\nimport { changeQueryObj } from '@util/tools';\r\n\r\nconst initialState = {\r\n  id: null,\r\n  mood: null,\r\n  isAlive: true,\r\n  forcedBehavior: null,\r\n  activities: []\r\n};\r\n\r\nexport default handleActions({\r\n  [setActivePetId.toString()]: (state, action) => {\r\n    const petObj = getPetDefinition(action.payload);\r\n    //- get stats, etc\r\n    if(petObj){\r\n      // const found = allPets.find(p => p.id === activePetId);\r\n  \r\n      if(petObj.isAlive){\r\n        return {\r\n          ...state,\r\n          id: petObj.id,\r\n          isAlive: true,\r\n          activities: [],\r\n          mood: null\r\n        }\r\n      }else{\r\n        return {\r\n          ...state,\r\n          id: petObj.id,\r\n          isAlive: false,\r\n          activities: [],\r\n          mood: 'DEAD'\r\n        }\r\n      }\r\n    }else{\r\n      return state;\r\n    }\r\n  },\r\n\r\n  [augmentStat.toString()]: (state, action) => {\r\n    augmentPetStat(state.id, action.payload.id, action.payload.value);\r\n    return state;\r\n  },\r\n\r\n  [addActivity.toString()]: (state, action) => {\r\n    const activity = action.payload;\r\n    // console.log('addActivity > ', activity);\r\n\r\n    if(state.activities.indexOf(activity) > -1){\r\n      return state;\r\n    }else{\r\n      return {\r\n        ...state,\r\n        activities: [ ...state.activities, activity ]\r\n      } \r\n    }\r\n  },\r\n\r\n  [removeActivity.toString()]: (state, action) => {\r\n    const activity = action.payload;\r\n    // console.error('removeActivity < ', activity);\r\n    \r\n    return {\r\n      ...state,\r\n      activities: state.activities.filter(a => a !== activity)\r\n    }\r\n  },\r\n\r\n  [forceBehavior.toString()]: (state, action) => {\r\n    const newBehavior = state.forcedBehavior !== action.payload ? action.payload : null;\r\n    return {\r\n      ...state,\r\n      forcedBehavior: newBehavior\r\n    }\r\n  },\r\n\r\n  [resetPet.toString()]: (state, action) => {\r\n    const petId = action.payload;\r\n\r\n    resetPetState(petId);\r\n\r\n    return {\r\n      ...state,\r\n      isAlive: true,\r\n      mood: null,\r\n      activities: []\r\n    }\r\n  },\r\n\r\n  [killPet.toString()]: (state, action) => {\r\n    console.log(\" KILL \", action.payload);\r\n    killThisPet(action.payload);\r\n\r\n    return {\r\n      ...state,\r\n      isAlive: false,\r\n      mood: 'DEAD',\r\n      activities: []\r\n    }\r\n  },\r\n\r\n  [clickPet.toString()]: (state, action) => {\r\n    const petId = action.payload;\r\n\r\n    if(state.isAlive){\r\n      killThisPet(action.payload);\r\n  \r\n      return {\r\n        ...state,\r\n        isAlive: false,\r\n        mood: 'DEAD',\r\n        activities: []\r\n      }\r\n    }else{\r\n      resetPetState(petId);\r\n  \r\n      return {\r\n        ...state,\r\n        isAlive: true,\r\n        mood: null,\r\n        activities: []\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  \r\n}, initialState);","import { combineReducers } from 'redux';\nimport data from './reducers/data';\nimport activePet from './reducers/active-pet';\n\nexport default combineReducers({\n  data,\n  activePet\n})\n","import { createStore, applyMiddleware, compose } from 'redux'\nimport thunk from 'redux-thunk'\nimport rootReducer from '@store/index.js'\n\nconst initialState = {}\nconst enhancers = []\nconst middleware = [thunk]\n\nif (process.env.NODE_ENV === 'development') {\n  const devToolsExtension = window.__REDUX_DEVTOOLS_EXTENSION__\n\n  if (typeof devToolsExtension === 'function') {\n    enhancers.push(devToolsExtension())\n  }\n}\n\nconst composedEnhancers = compose(\n  applyMiddleware(...middleware),\n  ...enhancers\n)\n\nexport default createStore(\n  rootReducer,\n  initialState,\n  composedEnhancers\n)\n","import React, { Component } from 'react';\r\nimport { bindActionCreators } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport { Route, withRouter, Redirect } from 'react-router-dom';\r\nimport styled from 'styled-components';\r\n\r\nimport { setActivePetId, loadExternalItem } from '@store/actions';\r\nimport { selectPetFromSearchQuery } from '@store/selectors/routes';\r\nimport { selectIsLoadingComplete} from '@store/selectors';\r\nimport { saveAllPetStatsToCookieNow } from '@util/pet-store';\r\nimport { themeGet } from '@themes/';\r\n\r\nimport Loader from './loader';\r\nimport Pinger from './pinger';\r\nimport Main from './main';\r\nimport Editor from '../editor';\r\nimport Menu from '@scenes/menu';\r\n\r\nconst S = {};\r\nS.App = styled.section`\r\n  position:absolute;\r\n  left:0;\r\n  top:0;\r\n  right:0;\r\n  bottom:0;\r\n  overflow:hidden;\r\n\r\n  background-color:  ${themeGet('color', 'black')};\r\n  color: ${themeGet('color', 'blue')};\r\n`\r\n\r\nclass AppContainer extends Component {\r\n  constructor(){\r\n    super();\r\n    global.spriteScale = 1; //- used to change sprite size/bounds, gets updated in cage.js when window is resized\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n      this.onExitPage();\r\n    });\r\n  }\r\n\r\n  onExitPage(){\r\n    if(this.props.loadingComplete) saveAllPetStatsToCookieNow();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState){\r\n    if(this.props.loadingComplete && !prevProps.loadingComplete){\r\n      this.onLoadComplete();\r\n    }\r\n  }\r\n\r\n  onLoadComplete(){\r\n    console.log('Load complete.');\r\n    this.loadDeeplinkedPet();\r\n  }\r\n\r\n  /* if query starts with \"external_\", then its a url to an external pet/manifest file and should be loaded */\r\n  loadDeeplinkedPet(force){\r\n    const petQuery = selectPetFromSearchQuery(this.props.location.search);\r\n\r\n    if(petQuery && (force || !this.props.activePetId)){\r\n      const queryPieces = petQuery.split('external_');\r\n      if(queryPieces.length > 1){\r\n        console.log(`--> Loading external pet with id \"${queryPieces[1]}`);\r\n        \r\n        this.props.loadExternalItem({ type: 'pets', url: queryPieces[1], id: `external_${queryPieces[1]}` });\r\n      }else{\r\n        this.props.setActivePetId(queryPieces[0]);\r\n      }\r\n    }\r\n  }\r\n\r\n  render(){\r\n    return(\r\n      <S.App id=\"app\" >\r\n        <Pinger />\r\n        <Loader/>\r\n        <Menu />\r\n        <Route exact path=\"/\" >\r\n          <Redirect to=\"/pet\" />\r\n        </Route>\r\n        <Route path='/pet' component={Main}></Route>\r\n        <Route path='/editor' component={Editor}></Route>\r\n      </S.App>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state, props) => ({\r\n  loadingComplete: selectIsLoadingComplete(state)\r\n})\r\n\r\nconst mapDispatchToProps = dispatch =>\r\n  bindActionCreators(\r\n    { setActivePetId, loadExternalItem },\r\n    dispatch\r\n  );\r\n\r\nexport default withRouter(connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(AppContainer))\r\n","\nimport { getSearchObj } from '@util/tools';\n\nexport const selectPetFromSearchQuery = queryString => {\n  if(!queryString) return null;\n\n  const obj = getSearchObj(queryString);\n  return obj.pet || null;\n}"],"sourceRoot":""}